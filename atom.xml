<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Michaelpig&#39;s blog</title>
  
  <subtitle>Michaelpig的實驗區</subtitle>
  <link href="https://michaelpig0912.github.io/atom.xml" rel="self"/>
  
  <link href="https://michaelpig0912.github.io/"/>
  <updated>2023-10-10T04:42:59.812Z</updated>
  <id>https://michaelpig0912.github.io/</id>
  
  <author>
    <name>Michael</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>透過 blender 做克拉尼圖形 (Chladni patterns)</title>
    <link href="https://michaelpig0912.github.io/2023/10/10/blenderChladniPatterns/"/>
    <id>https://michaelpig0912.github.io/2023/10/10/blenderChladniPatterns/</id>
    <published>2023-10-09T17:30:00.000Z</published>
    <updated>2023-10-10T04:42:59.812Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>克拉德尼圖案（Chladni Pattern）是一種由歐洲物理學家恩斯特·弗洛伊德里希·克拉德尼（Ernst Chladni）於18世紀末研究和描述的現象。這些圖案是在固體平板表面上產生的，通常是薄而平坦的金屬或玻璃板，並通過將其以不同方式振動來生成。</p><p>這次想透過強大的 blender 來模擬出克拉尼圖形，因此在網路上找了<a href="https://www.youtube.com/watch?v=Nqus6inp9Tk">教學影片</a>，照著這個影片嘗試著做出來克拉尼圖形。</p><img src="/2023/10/10/blenderChladniPatterns/ChladniPatterns01.webp" class="" title="blender 做出來的效果"><img src="/2023/10/10/blenderChladniPatterns/ChladniPatterns02.webp" class="" title="blender 做出來的效果"><div style="text-align:center"><iframe width="720" height="412" src="https://www.youtube.com/embed/24Gd1EyiL1U?si=bOKrzngwiZFkLb8D" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;前言&lt;/h2&gt;
&lt;p&gt;克拉德尼圖案（Chladni Pattern）是一種由歐洲物理學家恩斯特·弗洛伊德里希·克拉德尼（Ernst Chladni）於18世紀末研究和描述的現象。這些圖案是在固體平板表面上產生的，通常是薄而平坦的金屬或玻璃板，並通過將其以不</summary>
      
    
    
    
    <category term="3D" scheme="https://michaelpig0912.github.io/categories/3D/"/>
    
    
    <category term="blender" scheme="https://michaelpig0912.github.io/tags/blender/"/>
    
    <category term="3D" scheme="https://michaelpig0912.github.io/tags/3D/"/>
    
  </entry>
  
  <entry>
    <title>非專業戲劇紀錄｜搖滾芭比-音樂劇</title>
    <link href="https://michaelpig0912.github.io/2023/10/09/hedwigAndTheAngryInch/"/>
    <id>https://michaelpig0912.github.io/2023/10/09/hedwigAndTheAngryInch/</id>
    <published>2023-10-09T10:02:01.000Z</published>
    <updated>2023-10-09T17:16:22.420Z</updated>
    
    <content type="html"><![CDATA[<p style="font-size:1.5rem;color:#f55;text-align:center">注意：這是一個非專業的戲劇紀錄，僅記錄我個人的觀影經驗，並不是專業的戲劇評論。且以下的內容可能會有劇透，如果你還沒看過的話，可以先去看完再回來看這篇文章。</p><img src="/2023/10/09/hedwigAndTheAngryInch/out.webp" class="" title="搖滾芭比的海報"><h2 id="場域資訊">場域資訊</h2><ol><li>位置：CORNER MAX 大角落多功能展演館</li><li>價位：2000元</li><li>時間：10/8(六) 19:30~21:30</li><li>主觀評價：8/10</li><li>演員組合：蕭東意、金仁馨</li></ol><img src="/2023/10/09/hedwigAndTheAngryInch/cornerMax.webp" class="" title="CORNER MAX 大角落多功能展演館外觀"><h2 id="簡介">簡介</h2><p>故事的主要角色是 Hedwig，一位來自東德的變性女性，她經歷了一場變性手術，但手術不成功，不完美的性別轉變。Hedwig 尋求著身份和愛情的認同，並在搖滾樂界中追求自己的音樂事業。</p><p>Hedwig的旅程充滿了情感的波折，她經歷了愛情、背叛、自我發現和自我接受的過程。故事中的音樂和歌詞是 Hedwig 的內心情感的表現，也是她藉此展現自己的藝術和自我認同的方式。</p><img src="/2023/10/09/hedwigAndTheAngryInch/hedwigAndTheAngryInch.webp" class="" title="謝幕"><h2 id="個人觀感">個人觀感</h2><ol><li>這場音樂劇營造出 Hedwig 真的來到台灣舉辦演唱會，並且巧妙地加入了時事梗，使整體劇情更具當地風情，並且結合 Hedwig 毒舌的個性，讓這個人物感覺更立體了。</li><li>這部音樂劇與觀眾建立了直接互動，其中許多情節是即興演出，例如在演出中途有人進場，Hedwig 會嘴砲慢進來的觀眾一下，這種打破第四面牆的互動，讓觀眾參與感更強烈。</li><li>音樂劇中間有一段的演出，讓我回想起以前在泰國觀賞的 Ladyboy 表演。Hedwig 會親自下台與觀眾互動，在互動的過程中有人真的塞錢(印尼盾)，增加了一點效果， Hedwig 馬上來個即興的吐槽。</li><li>物件方面讓我印象深刻的地方是，透過一扇門內的燈光和音效，呈現出 Hedwig的宿敵 Tommy 在大巨蛋演唱的場景。聽到Tommy在門內的音樂和聲音，感覺彷彿置身於萬人擁場，而 Hedwig 卻只能在小場地表演，形成了滿有趣的對比。</li><li>演員的歌聲超強厲害，能充分的感受到其中的情緒與力道。歌詞的改編也非常出色，在現場聽的很過癮。</li><li>原本看完劇情大綱擔心會太過於說教。但實際並不會，整體看完是一個滿愉快的音樂劇。這部音樂劇探討了性別認同、愛情、到最後的自我接受，並以獨特的方式包裝了這些議題。</li><li>劇情中有一些地獄和黃色幽默的元素，對我來說是滿新鮮的體驗。</li></ol><h2 id="場地心得">場地心得</h2><ol><li>椅子不太好坐，就是一般的折疊椅，坐 110 分鐘有點累。</li><li>環境偏小，應該是因為這部戲是適合小場地的關係。</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p style=&quot;font-size:1.5rem;color:#f55;text-align:center&quot;&gt;
注意：這是一個非專業的戲劇紀錄，僅記錄我個人的觀影經驗，並不是專業的戲劇評論。且以下的內容可能會有劇透，如果你還沒看過的話，可以先去看完再回來看這篇文章。&lt;/p&gt;
</summary>
      
    
    
    
    <category term="drama" scheme="https://michaelpig0912.github.io/categories/drama/"/>
    
    
    <category term="show" scheme="https://michaelpig0912.github.io/tags/show/"/>
    
    <category term="drama" scheme="https://michaelpig0912.github.io/tags/drama/"/>
    
    <category term="musical" scheme="https://michaelpig0912.github.io/tags/musical/"/>
    
  </entry>
  
  <entry>
    <title>非專業戲劇紀錄｜伊底帕斯-音樂劇</title>
    <link href="https://michaelpig0912.github.io/2023/09/12/oedipusMusical/"/>
    <id>https://michaelpig0912.github.io/2023/09/12/oedipusMusical/</id>
    <published>2023-09-11T17:54:08.000Z</published>
    <updated>2023-09-11T18:25:47.258Z</updated>
    
    <content type="html"><![CDATA[<p style="font-size:1.5rem;color:#f55;text-align:center">注意：這是一個非專業的戲劇紀錄，僅記錄我個人的觀影經驗，並不是專業的戲劇評論。且以下的內容可能會有劇透，如果你還沒看過的話，可以先去看完再回來看這篇文章。</p><img src="/2023/09/12/oedipusMusical/oedipusMusical.webp" class="" title="謝幕"><h2 id="場域資訊">場域資訊</h2><ol><li>位置：新北市藝文中心演藝廳</li><li>價位：1440元</li><li>主觀評價：7.5分</li><li>時間：9/9(六) 14:30~16:00</li></ol><h2 id="簡介">簡介</h2><p>本劇是根據荷馬史詩所改編的，故事以伊底帕斯為主視角。</p><p>剛開始描述了他統治下的底比斯遭受著連綿不斷的瘟疫和怪物斯芬克斯。為了瞭解災禍的原因，派遣使臣去問神諭，但得到的答卻是「降下瘟疫的原因是因為底比斯國王被殺害多年，但兇手卻逍遙法外，如果要免除瘟疫，那就必須要抓到殺害國王的兇手」</p><p>在一個因緣際會下，伊底帕斯去德爾斐神殿裡請求神諭，而得到的神諭卻是勸伊底帕斯不要追查，最後會發現他不想發現的事情。伊底帕斯回想起曾經有預言說他會「弒父娶母」。為避免神諭成真，伊底帕斯便離開科林斯。伊底帕斯流浪到底比斯附近時，在三叉路上與一台馬車發生衝突，失手殺了全部的人，其中正包括他的生父萊瑤斯。</p><p>後來伊底帕斯經歷一連串的找尋跟思考過程，想拼命逃離神諭，但最終神諭全部靈驗，知道真相的柔卡絲塔上吊自殺，而伊底帕斯拿起柔卡絲塔的胸針刺向眼睛，試圖給予自己懲罰。</p><p>最終伊底帕斯為了底比斯人民而流放自己之際，盲眼的老人給予失去雙眼的伊底帕斯拐仗，讓伊底帕斯如同斯芬克斯之謎中所說的：「什麼東西在早晨用四條腿走路，中午用兩條腿，晚上用三條腿？」，而這個謎語正是反應了伊底帕斯的一生。</p><h2 id="個人觀感">個人觀感</h2><ol><li>本身對於古希臘文學不熟悉，因此想嘗試看看不同類型的戲劇，但剛開始看的時候可能會不太瞭解想要表達含意。會需要補充資料才能理解劇作家要傳達的寓意。</li><li>不過這部音樂劇主要以韓文為主，因此一定看字幕，造成有點分心。</li><li>這次的人物互動物件很少，但很成功的用簡單的物件來展現出了各種情緒與涵義，像是一條簡單的繩索可以是伊底帕斯還是嬰兒的時期，也可以是伊底帕斯綁在腳上的枷鎖或是攻擊的鞭子等等…。</li><li>在編舞上面滿有趣的，透過椅子整齊劃一的轉向顯示出從不同視角看伊底帕斯與使臣的對話過程。</li><li>透過霧氣與燈光製造的下雨景象，讓我大開眼見，原來室內的下雨的感覺可以這樣呈現。</li><li>這次的戲劇氣氛營造得很好，歌也非常好聽，而且是有些配音是現場演員直接配的，尤其是嬰兒的哭聲和，感覺超厲害的。</li></ol><h2 id="場地心得">場地心得</h2><ol><li>椅子蠻舒服的，但內部不可以拍照。</li><li>這次坐滿前面的，整體的觀影體驗很好。</li><li>這次可以跟演員拍照，滿特別的體驗，拍完的照片會放在FB粉專上面。</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p style=&quot;font-size:1.5rem;color:#f55;text-align:center&quot;&gt;
注意：這是一個非專業的戲劇紀錄，僅記錄我個人的觀影經驗，並不是專業的戲劇評論。且以下的內容可能會有劇透，如果你還沒看過的話，可以先去看完再回來看這篇文章。&lt;/p&gt;
</summary>
      
    
    
    
    <category term="drama" scheme="https://michaelpig0912.github.io/categories/drama/"/>
    
    
    <category term="show" scheme="https://michaelpig0912.github.io/tags/show/"/>
    
    <category term="drama" scheme="https://michaelpig0912.github.io/tags/drama/"/>
    
    <category term="musical" scheme="https://michaelpig0912.github.io/tags/musical/"/>
    
  </entry>
  
  <entry>
    <title>非專業戲劇紀錄｜鐵達尼號-音樂劇</title>
    <link href="https://michaelpig0912.github.io/2023/09/03/titanicTheMusical/"/>
    <id>https://michaelpig0912.github.io/2023/09/03/titanicTheMusical/</id>
    <published>2023-09-03T04:40:06.000Z</published>
    <updated>2023-09-11T18:22:49.791Z</updated>
    
    <content type="html"><![CDATA[<p style="font-size:1.5rem;color:#f55;text-align:center">注意：這是一個非專業的戲劇紀錄，僅記錄我個人的觀影經驗，並不是專業的戲劇評論。且以下的內容可能會有劇透，如果你還沒看過的話，可以先去看完再回來看這篇文章。</p><img src="/2023/09/03/titanicTheMusical/stage.webp" class="" title="內部場地圖"><h2 id="場域資訊">場域資訊</h2><ol><li>位置：台北表演藝術中心 大劇院</li><li>價位：1800元</li><li>時間：9/2(六) 14:30~17:30 (中間休息20分鐘)</li><li>主觀評價：8.5/10</li></ol><img src="/2023/09/03/titanicTheMusical/tpac.webp" class="" title="台北表演藝術中心"><h2 id="簡介">簡介</h2><p>這是一個關於鐵達尼號的故事，一個關於一艘偉大的船從概念設計到初航再到最終的沉沒。一開始，大家對於這艘船感到讚嘆，試圖以多種方式描述這個壯觀，龐大尺寸宛如一座漂浮的城市。在登船的時候，透過角色的對話得以了解乘客們背後的故事和背景。每一位乘客都是一個故事的主角，有人可能在這次旅行中計劃向心愛的人求婚，有人希望這趟旅程能夠拉近不同社會階層之間的距離。</p><p>當船撞上冰山時，故事變得更加戲劇化。各種人性的一面浮現，責任的推卸、恐慌的擴散，以及那些令人難忘的瞬間，揭示出人性在極端情況下的真實面貌。最終，倖存者思念著已故的摯愛，回憶著先前在碼頭上曾經對於未來充滿憧憬的場景。</p><img src="/2023/09/03/titanicTheMusical/titanicTheMusical.webp" class="" title="謝幕"><h2 id="個人觀感">個人觀感</h2><ol><li>第一次現場觀賞國外的音樂劇，這種體驗令我感到非常新奇。音樂和場景的效果都令人震撼，完美地呈現了整個故事情感的起伏，從一開始的充滿希望，到後來的緊張氛圍，彷彿讓我覺得自己就置身於那艘船上。</li><li>這部音樂劇巧妙地透過各種方式介紹角色，在開頭時的大媽(?)角色和船員，可以更深入地了解每個角色的背景故事。劇中的巧思讓即使坐在遠處的觀眾也能夠深刻理解角色的動機和情感。</li><li>儘管整個劇情主要發生在船上，場景變化有限，但是卻巧妙地運用了這有限的空間，呈現出多種不同的情境。例如，那個用來代表不同場景的梯子，有時是登船的梯子，有時又變成了瞭望台，觀眾可以藉由角色的動作清楚地理解物件的意義。</li><li>令我很厲害的是，在劇情上竟然可以處理的這麼好，儘管觀眾對於劇情的發展有所預期，但卻又透過這種認知來讓觀眾理解另外一個層次的感受。例如，一開始因遲到而未能登船的角色，他感覺很倒楣，但觀眾知道他實際上是幸運的。又或者有人對能夠搭上這艘船感到幸運，但卻不自知這將是一場惡夢的開端。</li><li>最後，當船隻沉沒時，角色內心的掙扎、責任的推卸，以及對生命盡頭的接受。這些情感表現令人難以忘懷。</li></ol><h2 id="場地心得">場地心得</h2><ol><li>椅子蠻舒服的，只不過腿部有點狹窄，如果有人人要過去，可能要站起來才過得去。</li><li>這次坐的位置比較偏一點，不過還是可以看到演員表情，只不過細部的動作可能就看不到了。</li><li>時間雖然稍長，但是不會累。</li><li>我的英文程度太爛，需要一直看字幕，有點影響到體驗。</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p style=&quot;font-size:1.5rem;color:#f55;text-align:center&quot;&gt;
注意：這是一個非專業的戲劇紀錄，僅記錄我個人的觀影經驗，並不是專業的戲劇評論。且以下的內容可能會有劇透，如果你還沒看過的話，可以先去看完再回來看這篇文章。&lt;/p&gt;
</summary>
      
    
    
    
    <category term="drama" scheme="https://michaelpig0912.github.io/categories/drama/"/>
    
    
    <category term="show" scheme="https://michaelpig0912.github.io/tags/show/"/>
    
    <category term="drama" scheme="https://michaelpig0912.github.io/tags/drama/"/>
    
    <category term="musical" scheme="https://michaelpig0912.github.io/tags/musical/"/>
    
  </entry>
  
  <entry>
    <title>Wonder Studio 簡單說明與自定義角色注意事項</title>
    <link href="https://michaelpig0912.github.io/2023/08/31/wonderStudioTutorial/"/>
    <id>https://michaelpig0912.github.io/2023/08/31/wonderStudioTutorial/</id>
    <published>2023-08-31T09:45:36.000Z</published>
    <updated>2023-09-04T16:29:04.239Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>Wonder Studio 是一個分析影片中真實人物的動作，然後可以做動態追蹤到指定的 3D 模型的服務，可以將影片中的人物轉換成 3D 人物，並且可以自定義角色，並且可以輸出 Blender 檔案，以及可以自動合成背景，這邊將簡單說明如何使用，以及講解該網站的自定義角色規範。</p><img src="/2023/08/31/wonderStudioTutorial/output.webp" class="" title="合成完成的結果"><hr><h2 id="註冊及付費">註冊及付費</h2><ol><li>先在 Wonder Studio 辦一個帳號，網址： <a href="https://wonderdynamics.com/">請點我</a></li></ol><img src="/2023/08/31/wonderStudioTutorial/main.webp" class="" title="左側選單"><ol start="2"><li><p>在左邊選單選 Upgrade Plan，記得注意上面是 Annual (年繳) ，還是 Monthly (月繳)，這次使用 lite 的方案就好。</p> <img src="/2023/08/31/wonderStudioTutorial/pay.webp" class="" title="方案頁面"></li><li><p>lite 帳號每個月大約要 20 鎂，大約是 600 元台幣，可以享有以下的功能：</p><ul><li>可以生成 150 秒的影片</li><li>六個自定義角色</li><li>兩個人的影片</li></ul></li><li><p>輸入信用卡號即可完成付費。</p></li></ol><hr><h2 id="建立專案">建立專案</h2><ol><li><p>按左邊的 Create New Project，並且選擇 Live Action Easy 的分頁按 Contunue。</p> <img src="/2023/08/31/wonderStudioTutorial/main.webp" class="" title="左側選單"></li><li><p>上傳一段影片到左邊的影片區。</p> <img src="/2023/08/31/wonderStudioTutorial/interface.webp" class="" title="主要頁面"></li><li><p>影片上傳完成後，將影片拉置中心，接著按上方的 Next 即可分析。</p> <img src="/2023/08/31/wonderStudioTutorial/uploadVideo.webp" class="" title="上傳完成"></li><li><p>接著可以將你要角色拉入畫面中的方框處，右邊可以選擇要用預設的角色檔案，還是自定義角色檔案。</p> <img src="/2023/08/31/wonderStudioTutorial/character.webp" class="" title="分析影片"></li><li><p>按下上面的 Next，會需要選擇要產生的檔案。 (這邊能勾選的全部都勾選)</p> <img src="/2023/08/31/wonderStudioTutorial/setting.webp" class="" title="選擇要產生的檔案"><ul><li>AI MoCap：會生成AI的骨架檔，但不包含臉臉部表情。格式是FBX。</li><li>Blender Scence ：全部運算的資料，但不包含背景，這個包含角色的shapeKey的表情。格式是Blender。</li><li>Clean Plate：生成空白的背景。格式為JPG。</li></ul></li><li><p>按下 Start Processing 就會開始運算，測試 10 秒的影片大約要跑 1~2 小時，不過運算時間計算似乎不是線性，不管幾秒幾乎都要一個小時以上。</p></li><li><p>完成以後在主畫面上面就會出現剛剛運算的影片，並且可以點選要下載的選項。</p> <img src="/2023/08/31/wonderStudioTutorial/output.webp" class="" title="分析完成，可以要下載的內容"></li></ol><hr><h2 id="自定義角色建立與規範">自定義角色建立與規範</h2><ol><li><a href="https://wonderdynamics.notion.site/Wonder-Dynamics-Character-Creation-Guidelines-4e7a932d2ffd49a89723e8ea80ba307d">官方的規範</a>，如果有任何問題可以看一下，不過有點小複雜，當初看有一點久。</li><li><a href="https://wonderdynamics.notion.site/Quick-Start-Guide-for-Blender-ccf6968493f64a39b55cbc93c635839b">官方的快速開始文檔</a></li><li>這邊已經假設你的角色已經是T pose，並且已經綁上所有骨架了。</li></ol><h3 id="以下將簡單講解-Blender-的規範">以下將簡單講解 Blender 的規範</h3><ol><li>官方最建議的版本為 <code>3.3.1</code> 版本，用其他版本很容易出錯。 <img src="/2023/08/31/wonderStudioTutorial/verOfBlender.webp" class="" title="官方版本推薦"></li></ol><h3 id="命名規範">命名規範</h3><ol><li><p>請建立一個 Collection 像圖片一樣，並命名為 <code>character</code>。</p> <img src="/2023/08/31/wonderStudioTutorial/settingName.webp" class="" title="命名規則"></li><li><p><code>角色</code>和<code>骨架</code>檔案請命名為 <code>角色名_BODY</code></p></li><li><p>骨骼的命名規範請依以下方式命名，以免進入軟體後偵測不到動作，如果有多出的骨骼名稱不用理會沒關係。</p> <details> <summary style="color:#F66"> 點我看骨架結構 </summary> <figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">- Hips</span><br><span class="line">    - Spine</span><br><span class="line">        - Spine1</span><br><span class="line">            - Spine2</span><br><span class="line">                - Neck</span><br><span class="line">                    - Head</span><br><span class="line">                - LeftShoulder</span><br><span class="line">                    - LeftArm</span><br><span class="line">                        - LeftForeArm</span><br><span class="line">                            - LeftHand</span><br><span class="line">                                - LeftHandThumb1</span><br><span class="line">                                    - LeftHandThumb2</span><br><span class="line">                                        - LeftHandThumb3</span><br><span class="line">                                - LeftHandIndex1</span><br><span class="line">                                    - LeftHandIndex2</span><br><span class="line">                                        - LeftHandIndex3</span><br><span class="line">                                - LeftHandMiddle1</span><br><span class="line">                                    - LeftHandMiddle2</span><br><span class="line">                                        - LeftHandMiddle3</span><br><span class="line">                                - LeftHandRing1</span><br><span class="line">                                    - LeftHandRing2</span><br><span class="line">                                        - LeftHandRing3</span><br><span class="line">                                - LeftHandPinky1</span><br><span class="line">                                    - LeftHandPinky2</span><br><span class="line">                                        - LeftHandPinky3</span><br><span class="line">                - RightShoulder</span><br><span class="line">                    - RightArm</span><br><span class="line">                        - RightForeArm</span><br><span class="line">                            - RightHand</span><br><span class="line">                                - RightHandThumb1</span><br><span class="line">                                    - RightHandThumb2</span><br><span class="line">                                        - RightHandThumb3</span><br><span class="line">                                - RightHandIndex1</span><br><span class="line">                                    - RightHandIndex2</span><br><span class="line">                                        - RightHandIndex3</span><br><span class="line">                                - RightHandMiddle1</span><br><span class="line">                                    - RightHandMiddle2</span><br><span class="line">                                        - RightHandMiddle3</span><br><span class="line">                                - RightHandRing1</span><br><span class="line">                                    - RightHandRing2</span><br><span class="line">                                        - RightHandRing3</span><br><span class="line">                                - RightHandPinky1</span><br><span class="line">                                    - RightHandPinky2</span><br><span class="line">                                        - RightHandPinky3</span><br><span class="line">    - LeftUpLeg</span><br><span class="line">        - LeftLeg</span><br><span class="line">            - LeftFoot</span><br><span class="line">                - LeftToeBase</span><br><span class="line">    - RightUpLeg</span><br><span class="line">        - RightLeg</span><br><span class="line">            - RightFoot</span><br><span class="line">                - RightToeBase</span><br></pre></td></tr></table></figure> </details></li><li><p>臉部需要 shapeKeys 控制，請命名內容需要包含 <code>_FACE</code>，例如 <code>dummy_FACE</code></p></li><li><p>命名請勿使用 <code>.</code>，例如：<code>dummy.001</code>，請把 <code>.</code> 換成 <code>_</code></p></li><li><p>材質需要有 <code>_MAT</code>，例如：<code>colt_MAT</code></p> <img src="/2023/08/31/wonderStudioTutorial/matSetting.webp" class="" title="材質的命名規則"><ol><li>如果在材質裡面有用到圖片或紋理之類的，請至少按照<code>[matName]_TEX_[type].[ext]</code> ，matName可以不用跟MAT一樣，另外要避免使用相同的名稱命名不同材質。<ul><li><a href="https://wonderdynamics.notion.site/Shading-Texturing-220ac163b959401c921a0859795b7b8d">官方的說明文檔</a></li><li>例如：一個衣服的材質圖片：<code>colt01_TEX_DIFF.png</code></li><li>以下是針對不同的材質命名規範  <details>  <summary style="color:#F66"> 點我看詳細的材質規則 </summary>  <figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">- Ambient Oclussion map → _TEX_AO</span><br><span class="line">- Anisotropy rotation map → _TEX_ANITROPROT</span><br><span class="line">- Anisotropy weight map → _TEX_ANITROP</span><br><span class="line">- Bump/Height map → _TEX_BUMP</span><br><span class="line">- Clearcoat weight map → TEX_COATWEIGHT</span><br><span class="line">- Diffuse map → _TEX_DIFF</span><br><span class="line">- Displacement map → _TEX_DISPLACE</span><br><span class="line">- Emission map → _TEX_EMISSION</span><br><span class="line">- Emission mask → _TEX_EMISSIONWEIGHT</span><br><span class="line">- Index of reflection map → _TEX_IOR</span><br><span class="line">- Metalness map → _TEX_METAL</span><br><span class="line">- Normal map → _TEX_NORM</span><br><span class="line">- Opacity/Alpha map → _TEX_OPAC</span><br><span class="line">- Roughness map → _TEX_ROUGH</span><br><span class="line">- Specular map → _TEX_SPEC</span><br><span class="line">- Subsurface Scattering map → _TEX_SSS</span><br><span class="line">- Thickness (SSS weight) map → _TEX_THICK</span><br><span class="line">- Transmission weight map → _TEX_TRANSWEIGHT</span><br></pre></td></tr></table></figure>  </details></li></ul></li></ol></li></ol><h3 id="臉部規範">臉部規範</h3><ol><li><a href="https://wonderdynamics.notion.site/Creating-Facial-for-Characters-6b938279399a4541914bccb5ba993436">官方的臉部說明檔案</a></li><li>命名規則是根據 <code>Facial Action Coding System (FACS)</code> 搭配 <code>shapeKey</code> 達成。</li><li>總共有 52 種，不一定每一種表情都要對到，可以挑幾個比較重要的做。</li><li>將 <code>ShapeKeys</code> 命名成官方文件上的名稱，就可讓角色有表情變化。<ul><li>例如下圖的：<code>jawIn</code> 或 <code>eyeBlinkR</code></li></ul> <img src="/2023/08/31/wonderStudioTutorial/facerig.webp" class="" title="臉部命名"></li></ol><h3 id="清理孤立數據">清理孤立數據</h3><ol><li>將 Display mode 改成 Orphan data</li><li>並且按下 Purge</li><li>存檔即可準備上傳。</li></ol><img src="/2023/08/31/wonderStudioTutorial/purge.webp" class="" title="清理孤立數據"><hr><h2 id="自定義角色上傳">自定義角色上傳</h2><ol><li>到編輯畫面的右邊，按下加號。</li></ol><img src="/2023/08/31/wonderStudioTutorial/ownCharacter.webp" class="" title="新增自定義角色"><ol start="2"><li>為角色取名並且繼續。</li></ol><img src="/2023/08/31/wonderStudioTutorial/uploadName.webp" class="" title="為角色取名"><ol start="3"><li>接下來準備好檔案，丟上依照規範做的 blender 檔案跟材質，拖上去上傳即可，接著等待上傳及驗證。</li></ol><img src="/2023/08/31/wonderStudioTutorial/uploadFile.webp" class="" title="上傳資料"><ol start="4"><li><p>不過如果模型有問題，會很容易卡在這一步。</p></li><li><p style=color:#F66>請注意 lite 帳號只能上傳 6 次角色，之後就要再等一個月才能上傳</p></li></ol><hr><h2 id="遇過的問題解法">遇過的問題解法</h2><p>Q1：object scale should be applied on Mesh as it currently is (1.0 1.0 1.000000516516)</p><p style=color:#F55>解法：輸入指定物件的 scale ，即使在blender上看到已經是 1 ，還是重新輸入設定為 1，記得要 apply scale。</p><p>Q2：object mesh has no parent armature blender</p><p style=color:#F55>解法：將指定的 mesh 透過 Modifiers 加入 Armature，並且 Object 選擇你的主要骨架。(請參考下圖)</p><img src="/2023/08/31/wonderStudioTutorial/settingArmature.webp" class="" title="Armature設定"><p>Q3：如果上傳後發現角色材質怪怪的，一片黑或一片白。</p><p style=color:#F55>解法：可能是材質命名錯誤，或是部分的功能不支援，先前有遇過如果在 blender 3.6 使用顏色的運算 (下方的黃色框框的內容) 會出錯，因為blender 3.6 已經將 mixRGB 刪除，建議使用blneder 3.4 版本以前的 mixRGB 運算上就不會出錯。</p><img src="/2023/08/31/wonderStudioTutorial/mixRGB.webp" class="" title="不支援問題"><p>Q4：下載下來材質遺失</p><p style=color:#F55>去 File > Extremal Data > Find Missing Files ，選擇材質就會回來了。</p><img src="/2023/08/31/wonderStudioTutorial/missingFile.webp" class="" title="重新連結素材">]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;前言&lt;/h2&gt;
&lt;p&gt;Wonder Studio 是一個分析影片中真實人物的動作，然後可以做動態追蹤到指定的 3D 模型的服務，可以將影片中的人物轉換成 3D 人物，並且可以自定義角色，並且可以輸出 Blender 檔案，以及可以自動合成背景，這邊將簡單說</summary>
      
    
    
    
    <category term="3D" scheme="https://michaelpig0912.github.io/categories/3D/"/>
    
    
    <category term="blender" scheme="https://michaelpig0912.github.io/tags/blender/"/>
    
    <category term="3D" scheme="https://michaelpig0912.github.io/tags/3D/"/>
    
    <category term="wonderStudio" scheme="https://michaelpig0912.github.io/tags/wonderStudio/"/>
    
  </entry>
  
  <entry>
    <title>實體的提醒小工具 Memo Switch</title>
    <link href="https://michaelpig0912.github.io/2023/08/20/memoSwitch/"/>
    <id>https://michaelpig0912.github.io/2023/08/20/memoSwitch/</id>
    <published>2023-08-20T05:54:17.000Z</published>
    <updated>2023-08-20T08:53:41.908Z</updated>
    
    <content type="html"><![CDATA[<h2 id="引言">引言</h2><p>這個是一個可以幫助紀錄日常生活的小工具，<br>先前在網路上有看過別人做過類似的東西，<br>感覺滿有趣的，所以也自己畫了設計圖來試試看。</p><p>這個小工具是一旦做過什麼事情後，<br>可以打開或關閉開關，<br>幫助你確認事情是否都已經完成了，<br>這個裝置有在 cover 旁邊留一個小縫，<br>方便抽換裡面的紙條，可以跟換你想記錄的事情。</p><div style="width:70%;margin:auto"><img src="/2023/08/20/memoSwitch/memoSwitch.webp" class="" title="裝置圖"></div><hr><h2 id="下載連結">下載連結</h2><p><a href="https://www.thingiverse.com/thing:6178122/files">點我下載設計圖</a></p><hr><h2 id="構造介紹">構造介紹</h2><p>本裝置可以分為三個部分：</p><ol><li>Base 底板</li></ol><img src="/2023/08/20/memoSwitch/base.webp" class="" title="底板"><ol start="2"><li>cover 蓋板</li></ol><img src="/2023/08/20/memoSwitch/cover.webp" class="" title="蓋板"><ol start="3"><li>switch 開關</li></ol><img src="/2023/08/20/memoSwitch/switch.webp" class="" title="開關"><hr><h2 id="需注意的地方">需注意的地方</h2><p>這個裝置有幾個部分需要加工</p><ol><li><p>switch 可能會有點難塞進去 cover 內，因此可能需要加工，或是列印的時候要縮小尺寸。</p></li><li><p>需要使用快乾將 cover 和 base 黏在一起。</p></li><li><p>底板的部分可以自己用簽字筆畫上顏色，讓開關的時候可以看到顏色變化</p></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;引言&quot;&gt;引言&lt;/h2&gt;
&lt;p&gt;這個是一個可以幫助紀錄日常生活的小工具，&lt;br&gt;
先前在網路上有看過別人做過類似的東西，&lt;br&gt;
感覺滿有趣的，所以也自己畫了設計圖來試試看。&lt;/p&gt;
&lt;p&gt;這個小工具是一旦做過什麼事情後，&lt;br&gt;
可以打開或關閉開關，&lt;br&gt;
幫助</summary>
      
    
    
    
    <category term="maker" scheme="https://michaelpig0912.github.io/categories/maker/"/>
    
    
    <category term="maker" scheme="https://michaelpig0912.github.io/tags/maker/"/>
    
  </entry>
  
  <entry>
    <title>用 ESP8266 做自動隨會議開關的OnAir燈箱</title>
    <link href="https://michaelpig0912.github.io/2023/08/01/OnAirBox/"/>
    <id>https://michaelpig0912.github.io/2023/08/01/OnAirBox/</id>
    <published>2023-08-01T07:26:14.000Z</published>
    <updated>2023-08-01T14:20:02.954Z</updated>
    
    <content type="html"><![CDATA[<h2 id="簡介">簡介</h2><p>最近公司想要做一個裝置，是當 google 行事曆有排會議時，就會自動ON AIR的燈箱。</p><img src="/2023/08/01/OnAirBox/OnAirDemo.webp" class="" title="燈箱的演示圖片"><hr><h3 id="大概的思考架構">大概的思考架構</h3><ol><li>由 google apps script 生成三天內行事曆的JSON網站。</li><li>接著由 ESP8266 去網站上面抓網頁的資訊。</li><li>ESP8266 判斷時間是否在會議的開始與結束時間，如果在這個區段內的話，進行亮燈、否則暗燈。</li></ol><hr><h2 id="所需材料與架構">所需材料與架構</h2><ol><li>esp8266</li><li>大創買的收納盒</li></ol><img src="/2023/08/01/OnAirBox/box.webp" class="" title="大創的收納盒"><ol start="3"><li>去文具行買玻璃紙與黑紙卡</li><li>影印店印ON AIR字卡</li><li>5V 燈條</li></ol><h2 id="注意事項">注意事項</h2><ol><li>燈條買SMD(直接焊在電路板的那種)，有嘗試使用大創賣的聖誕燈條，但是效果很醜。</li><li>玻璃紙與黑紙卡可以發揮自己創意改裝。</li></ol><hr><h2 id="Google-Apps-Script-設定">Google Apps Script 設定</h2><h3 id="首先進入google-apps-script">首先進入google apps script</h3><p>開一個新的檔案，將程式碼複製上去。</p><img src="/2023/08/01/OnAirBox/GAScode.webp" class="" title="將程式貼在圖中的這個位置"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">doGet</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> calendarId = <span class="string">&#x27;primary&#x27;</span>; <span class="comment">// Replace with your calendar ID</span></span><br><span class="line">  <span class="keyword">var</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">  <span class="keyword">var</span> nextWeek = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">  nextWeek.<span class="title function_">setDate</span>(nextWeek.<span class="title function_">getDate</span>() + <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> events = <span class="title class_">CalendarApp</span>.<span class="title function_">getCalendarById</span>(calendarId).<span class="title function_">getEvents</span>(now, nextWeek);</span><br><span class="line">  <span class="keyword">var</span> output = events.<span class="title function_">map</span>(<span class="keyword">function</span>(<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="string">&#x27;title&#x27;</span>: event.<span class="title function_">getTitle</span>(),</span><br><span class="line">      <span class="string">&#x27;start&#x27;</span>: <span class="title class_">Math</span>.<span class="title function_">floor</span>(event.<span class="title function_">getStartTime</span>().<span class="title function_">getTime</span>() / <span class="number">1000</span>), <span class="comment">// Convert to Unix timestamp</span></span><br><span class="line">      <span class="string">&#x27;end&#x27;</span>: <span class="title class_">Math</span>.<span class="title function_">floor</span>(event.<span class="title function_">getEndTime</span>().<span class="title function_">getTime</span>() / <span class="number">1000</span>) <span class="comment">// Convert to Unix timestamp</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">ContentService</span>.<span class="title function_">createTextOutput</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(output))</span><br><span class="line">    .<span class="title function_">setMimeType</span>(<span class="title class_">ContentService</span>.<span class="property">MimeType</span>.<span class="property">JSON</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li><code>calendarId</code>可以換成你想要的日曆ID。</li><li>ID的位置在日曆的旁邊會看到三個點點，點進去設定。</li></ol><img src="/2023/08/01/OnAirBox/setcalendar1.webp" class="" title="點擊你要的日曆的點點，並且點擊設定"><ol start="3"><li>往下滑即可找到日曆ID</li></ol><img src="/2023/08/01/OnAirBox/setcalendar2.webp" class="" title="日曆ID在螢光筆的位置"><h3 id="部屬網站">部屬網站</h3><ol><li>按上面的【執行】，這時候可能會跳行事曆的授權，按確認即可。(如果沒有跑出來，可以再按一次執行)</li><li>接著按右上角的【部屬】&gt;【新增部屬工具】</li><li>按左上角的齒輪&gt;【網頁應用程式】</li><li>執行身分 [我]</li><li>誰可以存取 [所有人]<br>即可完成部屬</li></ol><h3 id="紀錄ID及網站">紀錄ID及網站</h3><p>(如果不見可以從【部屬】&gt;【管理部屬工具】找)</p><ol><li>接著會看到<code>部屬ID</code>跟網址，請將<code>部屬ID</code>記錄好。</li><li>網址可以測試看看是否可以順利看到JSON檔案</li><li>記得如果有跟改任何參數記得重新佈署一次</li></ol><p>網址點進去應該會看到這樣：</p><img src="/2023/08/01/OnAirBox/websiteJson.webp" class="" title="網址內會看到會議跟一堆時間碼"><p>note：本程式為了之後容易計算，因此時間是使用UNIX時間來表示</p><p>到目前已經完成網站端的配置了，接下來要來進行ESP32的部分。</p><h2 id="ESP8266-設定">ESP8266 設定</h2><h3 id="ESP8266硬體安裝">ESP8266硬體安裝</h3><p>這次使用的是ESP8266上的D0腳位，將燈條的正極接在D0，負極接在GND上。</p><h3 id="將程式貼進IDE">將程式貼進IDE</h3><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ESP8266WiFi.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ESP8266HTTPClient.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;WiFiClientSecureBearSSL.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ArduinoJson.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//wifi帳號密碼</span></span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* ssid = <span class="string">&quot;***&quot;</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* password = <span class="string">&quot;***&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Script ID.</span></span><br><span class="line"><span class="type">const</span> <span class="type">char</span> *GScriptId = <span class="string">&quot;***&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">String</span> resource = <span class="string">&quot;/macros/s/&quot;</span> + <span class="built_in">String</span>(GScriptId) + <span class="string">&quot;/exec&quot;</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* host = <span class="string">&quot;https://script.google.com&quot;</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">long</span> timezoneOffset = <span class="number">8</span> * <span class="number">60</span> * <span class="number">60</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> ledPin = D0;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">begin</span>(<span class="number">115200</span>);</span><br><span class="line">  <span class="built_in">pinMode</span>(ledPin, <span class="literal">OUTPUT</span>);</span><br><span class="line">  <span class="built_in">WiFi</span>.<span class="built_in">begin</span>(ssid, password);</span><br><span class="line">  <span class="keyword">while</span> (<span class="built_in">WiFi</span>.<span class="built_in">status</span>() != WL_CONNECTED) &#123;</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">configTime</span>(timezoneOffset, <span class="number">0</span>, <span class="string">&quot;pool.ntp.org&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">WiFi</span>.<span class="built_in">status</span>() == WL_CONNECTED) &#123;</span><br><span class="line">    <span class="function">std::unique_ptr&lt;BearSSL::WiFiClientSecure&gt; <span class="title">client</span><span class="params">(<span class="keyword">new</span> BearSSL::WiFiClientSecure)</span></span>;</span><br><span class="line">    client-&gt;<span class="built_in">setInsecure</span>();</span><br><span class="line">    HTTPClient http;</span><br><span class="line">    http.<span class="built_in">setFollowRedirects</span>(HTTPC_STRICT_FOLLOW_REDIRECTS);</span><br><span class="line">    http.<span class="built_in">begin</span>(*client, host + resource);</span><br><span class="line">    <span class="type">int</span> httpCode = http.<span class="built_in">GET</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (httpCode &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="type">String</span> payload = http.<span class="built_in">getString</span>();</span><br><span class="line">      <span class="built_in">Serial</span>.<span class="built_in">println</span>(httpCode);</span><br><span class="line">      <span class="built_in">Serial</span>.<span class="built_in">println</span>(payload);</span><br><span class="line"></span><br><span class="line">      <span class="function">DynamicJsonDocument <span class="title">doc</span><span class="params">(<span class="number">1024</span>)</span></span>;</span><br><span class="line">      <span class="built_in">deserializeJson</span>(doc, payload);</span><br><span class="line"></span><br><span class="line">      <span class="type">time_t</span> now;</span><br><span class="line">      <span class="built_in">time</span>(&amp;now);</span><br><span class="line">      <span class="type">int</span> nearestIndex = <span class="number">-1</span>;</span><br><span class="line">      <span class="type">time_t</span> nearestDiff = INT_MAX;</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; doc.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">        <span class="type">time_t</span> start = doc[i][<span class="string">&quot;start&quot;</span>].<span class="built_in">as</span>&lt;<span class="type">long</span>&gt;() + timezoneOffset;</span><br><span class="line">        <span class="type">time_t</span> diff = <span class="built_in">abs</span>(now - start);</span><br><span class="line">        <span class="keyword">if</span> (diff &lt; nearestDiff) &#123;</span><br><span class="line">          nearestIndex = i;</span><br><span class="line">          nearestDiff = diff;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (nearestIndex != <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="type">time_t</span> start = doc[nearestIndex][<span class="string">&quot;start&quot;</span>].<span class="built_in">as</span>&lt;<span class="type">long</span>&gt;();</span><br><span class="line">        <span class="type">time_t</span> end = doc[nearestIndex][<span class="string">&quot;end&quot;</span>].<span class="built_in">as</span>&lt;<span class="type">long</span>&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (now &gt;= start &amp;&amp; now &lt;= end) &#123;</span><br><span class="line">          <span class="built_in">digitalWrite</span>(ledPin, <span class="literal">HIGH</span>);</span><br><span class="line">          <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot;燈泡情況：ON&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="built_in">digitalWrite</span>(ledPin, <span class="literal">LOW</span>);</span><br><span class="line">          <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot;燈泡情況：OFF&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      payload = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    http.<span class="built_in">end</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">30000</span>);</span><br><span class="line">  <span class="comment">//30秒抓一次資料</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="修改程式">修改程式</h3><p>將裡面的 wifi 帳號、密碼和 Script ID 改成<code>部屬ID</code>的資料。<br>上傳到ESP8266 即可正常執行。</p><p>如果無法正常執行可以檢查序列埠視窗，理論上應該可以看到JSON資料跟燈泡ON/OFF情況。(如下圖所示)</p><img src="/2023/08/01/OnAirBox/serialData.webp" class="" title="序列埠視窗的資料"><p>另外提醒，本裝置是 30 秒抓一次資料，如果要及時一點，可以減少<code>delay time</code>。</p><h2 id="全部組合">全部組合</h2><ol><li>做完以上步驟以後，會獲得一個會隨著會議時間亮燈跟暗燈的裝置。</li><li>玻璃紙與黑紙卡可以發揮自己創意改裝。我目前嘗試出，前面貼印刷的ON AIR字卡，後面用厚紙板割開ON AIR字樣後黏在一起，效果還不錯。</li><li>接著將大創買來的盒子挖一個洞，並且將裝置與紙卡放進去，電線拉出來。</li></ol><img src="/2023/08/01/OnAirBox/box.webp" class="" title="大創的收納盒"><ol start="4"><li>即可完成你的燈箱。</li></ol><img src="/2023/08/01/OnAirBox/OnAirDemo2.webp" class="" title="燈箱完成圖">]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;簡介&quot;&gt;簡介&lt;/h2&gt;
&lt;p&gt;最近公司想要做一個裝置，是當 google 行事曆有排會議時，就會自動ON AIR的燈箱。&lt;/p&gt;
&lt;img src=&quot;/2023/08/01/OnAirBox/OnAirDemo.webp&quot; class=&quot;&quot; title=&quot;燈箱的演</summary>
      
    
    
    
    <category term="maker" scheme="https://michaelpig0912.github.io/categories/maker/"/>
    
    
    <category term="arduino" scheme="https://michaelpig0912.github.io/tags/arduino/"/>
    
    <category term="code" scheme="https://michaelpig0912.github.io/tags/code/"/>
    
    <category term="maker" scheme="https://michaelpig0912.github.io/tags/maker/"/>
    
    <category term="esp8266" scheme="https://michaelpig0912.github.io/tags/esp8266/"/>
    
    <category term="Google Apps Script" scheme="https://michaelpig0912.github.io/tags/Google-Apps-Script/"/>
    
  </entry>
  
  <entry>
    <title>整合 google 會議簡報自動生成和slack通知自動化程式碼</title>
    <link href="https://michaelpig0912.github.io/2023/07/26/MeetingSlidesGeneratorAndNotifier/"/>
    <id>https://michaelpig0912.github.io/2023/07/26/MeetingSlidesGeneratorAndNotifier/</id>
    <published>2023-07-26T08:52:36.000Z</published>
    <updated>2023-08-01T14:18:16.589Z</updated>
    
    <content type="html"><![CDATA[<h2 id="引言">引言</h2><p>在我們日常的工作中，準備會議和記錄會議與通知是一個必要但卻耗時的任務。今天將要寫一個透過 Google Apps Script (GAS) 來每天判斷行事曆事件，並且自動生成通知及新的會議紀錄表的程式碼。</p><hr><h2 id="可達到的功能">可達到的功能</h2><ol><li>它能夠自動檢查你的 Google 日曆，找出預定在明天的包含特定關鍵字的會議，</li><li>為這些會議自動生成 Google 簡報，</li><li>然後將這次簡報與最近一次的會議紀錄文件連結透過  Slack Webhook 發送給相關人員。</li><li>可以定時檢查行事曆。</li></ol><hr><h2 id="如何使用">如何使用</h2><h3 id="設定slack的webhook">設定slack的webhook</h3><p>在這個過程中比較特別的需要使用</p><ol><li>slack webhook：<a href="https://slack.com/apps/A0F7XDUAZ-incoming-webhook?tab=more_info">https://slack.com/apps/A0F7XDUAZ-incoming-webhook?tab=more_info</a></li><li>將內容填寫好以後，複製webhook URL到 Google Apps Script</li></ol><img src="/2023/07/26/MeetingSlidesGeneratorAndNotifier/webhookSet.webp" class="" title="slack webhook填寫內容"><h3 id="將程式貼上GAS">將程式貼上GAS</h3><p>將程式碼貼上Google Apps Script</p><img src="/2023/07/26/MeetingSlidesGeneratorAndNotifier/GASdemo.webp" class="" title="貼上程式碼的位置"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 你的 Slack webhook URL</span></span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">WEBHOOK_URL</span> = <span class="string">&#x27;dummy&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 包含特定文字的事件的搜尋字串</span></span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">EVENT_KEYWORD</span> = <span class="string">&#x27;dummy&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成 Google 簡報的範本 ID</span></span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">SLIDES_TEMPLATE_ID</span> = <span class="string">&#x27;dummy&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 雲端硬碟文件夾的 ID</span></span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">FOLDER_ID</span> = <span class="string">&#x27;dummy&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">CALENDAR_IDS</span> = [<span class="string">&#x27;dummy&#x27;</span>,<span class="string">&#x27;dummy&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkMeetings</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> tomorrow = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">  tomorrow.<span class="title function_">setDate</span>(tomorrow.<span class="title function_">getDate</span>() + <span class="number">1</span>);</span><br><span class="line">  tomorrow.<span class="title function_">setHours</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> nextDay = <span class="keyword">new</span> <span class="title class_">Date</span>(tomorrow);</span><br><span class="line">  nextDay.<span class="title function_">setDate</span>(nextDay.<span class="title function_">getDate</span>() + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title class_">Logger</span>.<span class="title function_">log</span>(<span class="string">&#x27;Tomorrow: &#x27;</span> + tomorrow);</span><br><span class="line">  <span class="title class_">Logger</span>.<span class="title function_">log</span>(<span class="string">&#x27;Next Day: &#x27;</span> + nextDay);</span><br><span class="line"></span><br><span class="line">  <span class="title class_">Logger</span>.<span class="title function_">log</span>(<span class="string">&#x27;Checking meetings for calendars: &#x27;</span> + <span class="variable constant_">CALENDAR_IDS</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable constant_">CALENDAR_IDS</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> calendar = <span class="title class_">CalendarApp</span>.<span class="title function_">getCalendarById</span>(<span class="variable constant_">CALENDAR_IDS</span>[i]);</span><br><span class="line">    <span class="keyword">if</span> (calendar) &#123;</span><br><span class="line">      <span class="title class_">Logger</span>.<span class="title function_">log</span>(<span class="string">&#x27;Checking calendar: &#x27;</span> + <span class="variable constant_">CALENDAR_IDS</span>[i]);</span><br><span class="line">      <span class="keyword">const</span> events = calendar.<span class="title function_">getEvents</span>(tomorrow, nextDay);</span><br><span class="line"></span><br><span class="line">      <span class="title class_">Logger</span>.<span class="title function_">log</span>(<span class="string">&#x27;Found &#x27;</span> + events.<span class="property">length</span> + <span class="string">&#x27; events for calendar: &#x27;</span> + <span class="variable constant_">CALENDAR_IDS</span>[i]);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; events.<span class="property">length</span>; j++) &#123;</span><br><span class="line">        <span class="title class_">Logger</span>.<span class="title function_">log</span>(<span class="string">&#x27;Event: &#x27;</span> + events[j].<span class="title function_">getTitle</span>());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (events[j].<span class="title function_">getTitle</span>().<span class="title function_">includes</span>(<span class="variable constant_">EVENT_KEYWORD</span>)) &#123;</span><br><span class="line">          <span class="title class_">Logger</span>.<span class="title function_">log</span>(<span class="string">&#x27;Event: &#x27;</span> + events[j].<span class="title function_">getTitle</span>() + <span class="string">&#x27; contains keyword: &#x27;</span> + <span class="variable constant_">EVENT_KEYWORD</span>);</span><br><span class="line">          <span class="keyword">const</span> slidesUrl = <span class="title function_">createMeetingSlides</span>(events[j]);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">const</span> recentMeetingUrl = <span class="title function_">findRecentMeetingFile</span>();</span><br><span class="line">          <span class="title class_">Logger</span>.<span class="title function_">log</span>(<span class="string">&#x27;Recent Meeting File: &#x27;</span> + recentMeetingUrl);</span><br><span class="line"></span><br><span class="line">          <span class="title function_">sendSlackMessage</span>(slidesUrl, recentMeetingUrl);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title class_">Logger</span>.<span class="title function_">log</span>(<span class="string">&#x27;No calendar found for ID: &#x27;</span> + <span class="variable constant_">CALENDAR_IDS</span>[i]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createMeetingSlides</span>(<span class="params">event</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> date = event.<span class="title function_">getStartTime</span>();</span><br><span class="line">  <span class="keyword">var</span> formattedDate = <span class="title function_">getFormattedDate</span>(date);</span><br><span class="line">  <span class="keyword">var</span> title = <span class="string">&quot;你想要的標題&quot;</span> + <span class="string">&#x27;_&#x27;</span> + formattedDate;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> file = <span class="title class_">DriveApp</span>.<span class="title function_">getFileById</span>(<span class="variable constant_">SLIDES_TEMPLATE_ID</span>);</span><br><span class="line">  <span class="keyword">var</span> folder = <span class="title class_">DriveApp</span>.<span class="title function_">getFolderById</span>(<span class="variable constant_">FOLDER_ID</span>);</span><br><span class="line">  <span class="keyword">var</span> copiedFile = file.<span class="title function_">makeCopy</span>(title, folder);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> presentation = <span class="title class_">SlidesApp</span>.<span class="title function_">openById</span>(copiedFile.<span class="title function_">getId</span>());</span><br><span class="line">  <span class="keyword">var</span> firstSlide = presentation.<span class="title function_">getSlides</span>()[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> textShape = firstSlide.<span class="title function_">getShapes</span>()[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">if</span> (textShape.<span class="property">getText</span>) &#123;</span><br><span class="line">    textShape.<span class="title function_">getText</span>().<span class="title function_">setText</span>(title);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;https://docs.google.com/presentation/d/&#x27;</span> + copiedFile.<span class="title function_">getId</span>() + <span class="string">&#x27;/edit&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getFormattedDate</span>(<span class="params">date</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> year = date.<span class="title function_">getFullYear</span>();</span><br><span class="line">  <span class="keyword">var</span> month = date.<span class="title function_">getMonth</span>() + <span class="number">1</span>; </span><br><span class="line">  <span class="keyword">var</span> day = date.<span class="title function_">getDate</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (month &lt; <span class="number">10</span>) &#123;</span><br><span class="line">    month = <span class="string">&#x27;0&#x27;</span> + month;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (day &lt; <span class="number">10</span>) &#123;</span><br><span class="line">    day = <span class="string">&#x27;0&#x27;</span> + day;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span> + year + month + day;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sendSlackMessage</span>(<span class="params">slidesUrl, recentMeetingUrl</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> payload = &#123;</span><br><span class="line">    <span class="attr">text</span>: <span class="string">&#x27;請更新您的簡報進度，簡報連結如下：&#x27;</span> + slidesUrl +</span><br><span class="line">          (recentMeetingUrl ? <span class="string">&#x27;\n最近的會議紀錄可以在這裡找到：&#x27;</span> + recentMeetingUrl : <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> options = &#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">    <span class="attr">payload</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(payload)</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title class_">UrlFetchApp</span>.<span class="title function_">fetch</span>(<span class="variable constant_">WEBHOOK_URL</span>, options);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">findRecentMeetingFile</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> folder = <span class="title class_">DriveApp</span>.<span class="title function_">getFolderById</span>(<span class="variable constant_">FOLDER_ID</span>);</span><br><span class="line">  <span class="keyword">const</span> files = folder.<span class="title function_">searchFiles</span>(<span class="string">&#x27;title contains &quot;你想要的標題_&quot;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Add all matching files to an array.</span></span><br><span class="line">  <span class="keyword">let</span> fileArray = [];</span><br><span class="line">  <span class="keyword">while</span> (files.<span class="title function_">hasNext</span>()) &#123;</span><br><span class="line">    <span class="keyword">const</span> file = files.<span class="title function_">next</span>();</span><br><span class="line">    fileArray.<span class="title function_">push</span>(file);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Sort the array by creation date.</span></span><br><span class="line">  fileArray.<span class="title function_">sort</span>(<span class="keyword">function</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> b.<span class="title function_">getDateCreated</span>() - a.<span class="title function_">getDateCreated</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Return the URL of the second most recent file (if it exists).</span></span><br><span class="line">  <span class="keyword">if</span> (fileArray.<span class="property">length</span> &gt; <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;https://docs.google.com/presentation/d/&#x27;</span> + fileArray[<span class="number">1</span>].<span class="title function_">getId</span>() + <span class="string">&#x27;/edit&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="修改參數">修改參數</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定義您的 Slack webhook URL</span></span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">WEBHOOK_URL</span> = <span class="string">&#x27;dummy&#x27;</span>;</span><br><span class="line"><span class="comment">// 包含特定文字的事件的搜尋字串</span></span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">EVENT_KEYWORD</span> = <span class="string">&#x27;日曆包含的字串&#x27;</span>;</span><br><span class="line"><span class="comment">// 生成 Google 簡報的範本 ID</span></span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">SLIDES_TEMPLATE_ID</span> = <span class="string">&#x27;dummy&#x27;</span>;</span><br><span class="line"><span class="comment">// 雲端硬碟文件夾的 ID</span></span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">FOLDER_ID</span> = <span class="string">&#x27;dummy&#x27;</span>;</span><br><span class="line"><span class="comment">// 行事曆的 ID</span></span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">CALENDAR_IDS</span> = [<span class="string">&#x27;dummy&#x27;</span>,<span class="string">&#x27;dummy&#x27;</span>]</span><br></pre></td></tr></table></figure><h3 id="接著執行">接著執行</h3><ol><li>這個只需要執行，並不需要部屬</li><li>過程中可能會遇到需要權限的部分</li></ol><h3 id="設定觸發器">設定觸發器</h3><p>為了要讓這個程式固定檢查時間檢查跟傳送slack訊息，<br>因此需要設定觸發器，這邊示範是在每天晚上6:00~7:00間會檢查明天會議的狀況。</p><ol><li>先點擊儀表左邊像鬧鐘的符號(第三個)</li></ol><img src="/2023/07/26/MeetingSlidesGeneratorAndNotifier/tri-0.webp" class="" title="像鬧鐘的圖案"><ol start="2"><li>接著在右下角點擊&quot;新增觸發條件&quot;</li></ol><img src="/2023/07/26/MeetingSlidesGeneratorAndNotifier/tri-1.webp" class="" title="這個按鈕"><ol start="3"><li>設定觸發條件如下圖所示</li></ol><img src="/2023/07/26/MeetingSlidesGeneratorAndNotifier/tri-2.webp" class="" title="觸發條件示範"><p>note：不過比較奇怪的是無法設定準確的時間提醒，<br>我們測試後發現都會在設定時間的20分鐘左右才收到系統的通知。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;引言&quot;&gt;引言&lt;/h2&gt;
&lt;p&gt;在我們日常的工作中，準備會議和記錄會議與通知是一個必要但卻耗時的任務。今天將要寫一個透過 Google Apps Script (GAS) 來每天判斷行事曆事件，並且自動生成通知及新的會議紀錄表的程式碼。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 i</summary>
      
    
    
    
    <category term="code" scheme="https://michaelpig0912.github.io/categories/code/"/>
    
    
    <category term="code" scheme="https://michaelpig0912.github.io/tags/code/"/>
    
    <category term="Google Apps Script" scheme="https://michaelpig0912.github.io/tags/Google-Apps-Script/"/>
    
    <category term="javascript" scheme="https://michaelpig0912.github.io/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>非專業戲劇紀錄｜我們與惡的距離(公投版)-舞台劇</title>
    <link href="https://michaelpig0912.github.io/2023/07/10/TheWorldBetweenUs-musical/"/>
    <id>https://michaelpig0912.github.io/2023/07/10/TheWorldBetweenUs-musical/</id>
    <published>2023-07-10T07:46:22.000Z</published>
    <updated>2023-09-03T11:32:28.159Z</updated>
    
    <content type="html"><![CDATA[<p style="font-size:1.5rem;color:#f55;text-align:center">注意：這是一個非專業的戲劇紀錄，僅記錄我個人的觀影經驗，並不是專業的戲劇評論。且以下的內容可能會有劇透，如果你還沒看過的話，可以先去看完再回來看這篇文章。</p><img src="/2023/07/10/TheWorldBetweenUs-musical/theWorldBetweenUs.webp" class="" title="內部場地圖"><h2 id="場域資訊">場域資訊</h2><ol><li>位置：城市舞台</li><li>價位：750元(原價 1500元)</li><li>時間：7/9(日) 19:30~22:30</li><li>主觀評價：7/10</li></ol><img src="/2023/07/10/TheWorldBetweenUs-musical/place.webp" class="" title="城市舞台的外觀"><h2 id="個人觀感">個人觀感</h2><ol><li>戲院槍擊的處理方式也滿新鮮的，滿&quot;身歷其境&quot;的；佈景很用心，很還原戲劇中的模樣。</li><li>演員表現很厲害，大芝母親的哭喊和宋喬安在經過一些事情後的無力感，情緒感染有引起我的情緒。</li><li>透過投票與現場政論節目互動的方式，這種打破第四面牆的展示手法，讓我感覺蠻新鮮的。<ol><li>用line投票劇本走向，透過方式也展現出公民投票的含意，這個手法滿有趣的。</li></ol> <div style="width:50%;margin:auto"><img src="/2023/07/10/TheWorldBetweenUs-musical/line.webp" class="" title="投票的結果"></div></li><li>議題討論的方面帶的蠻有趣的，我在當時要嘗試這在腦海中想出幾個對於死刑相關的問題，是很明顯卡住的。</li><li>看完以後心情有點複雜，因為本身已經看完電視劇，所以這次的觀影體驗比較像是複習，雖然還是又有一些地方做調整，但大體上走向與台詞都差不多，缺少很多驚喜感。</li><li>了解導演想要帶給大家的是你以為的正義，不一定是真的正義，劇情走向有點太過簡單，且說教感有點重。</li><li>結尾有點快結束，總感覺缺少了什麼。</li></ol><h2 id="場地心得">場地心得</h2><ol><li>城市舞台的椅子蠻舒服的，只不過腿部伸展空間不夠</li><li>位置坐在中間偏前，位置還不錯，正中間且可以看的演員表情。</li><li>美中不足的可能是，因為票價比較便宜，觀看的人左邊人手機在前半場有聲音，右邊的人看到一半開始梳頭髮？？？？？</li><li>時間稍長 180 分鐘，中間休息 20 分鐘，在後半段，一直發現右邊的人在動來動去和喝水，有點影響觀影體驗。</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p style=&quot;font-size:1.5rem;color:#f55;text-align:center&quot;&gt;
注意：這是一個非專業的戲劇紀錄，僅記錄我個人的觀影經驗，並不是專業的戲劇評論。且以下的內容可能會有劇透，如果你還沒看過的話，可以先去看完再回來看這篇文章。&lt;/p&gt;
</summary>
      
    
    
    
    <category term="drama" scheme="https://michaelpig0912.github.io/categories/drama/"/>
    
    
    <category term="stage" scheme="https://michaelpig0912.github.io/tags/stage/"/>
    
    <category term="show" scheme="https://michaelpig0912.github.io/tags/show/"/>
    
    <category term="drama" scheme="https://michaelpig0912.github.io/tags/drama/"/>
    
  </entry>
  
  <entry>
    <title>簡單電解氯化鈉、硫酸鋅、氯化銅</title>
    <link href="https://michaelpig0912.github.io/2023/06/20/electrolysis/"/>
    <id>https://michaelpig0912.github.io/2023/06/20/electrolysis/</id>
    <published>2023-06-20T12:41:32.000Z</published>
    <updated>2023-09-03T17:34:24.980Z</updated>
    
    <content type="html"><![CDATA[<h2 id="裝置簡介">裝置簡介</h2><p>透過 4 顆 9V 電池，將筆芯接上鱷魚夾，來進行電解氯化鈉、硫酸鋅、氯化銅，並且觀察其反應。</p><img src="/2023/06/20/electrolysis/set.webp" class="" title="電解 裝置簡介"><h2 id="實驗畫面">實驗畫面</h2><h3 id="電解氯化鈉">電解氯化鈉</h3><div style="text-align:center"><iframe width="405" height="720" src="https://www.youtube.com/embed/vCrLzQNRZAI?si=hjace8ZueN3G9_AL" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe><br>(過程中可能會產生氯氣，請注意通風)</div><h3 id="電解硫酸鋅">電解硫酸鋅</h3><div style="text-align:center"><iframe width="405" height="720" src="https://www.youtube.com/embed/aNfJCTx1czQ?si=oqoS0uiV5IX0ltkt" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe><br>一端會產生氣體，另一端會產生鋅。</div><h3 id="電解氯化銅">電解氯化銅</h3><div style="text-align:center"><iframe width="405" height="720" src="https://www.youtube.com/embed/AQKCasrR6lc?si=5LbRpkmZWogf1qM_" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe><br>一端會產生氯氣，另一端會產生銅。<br>(過程中可能會產生氯氣，請注意通風)</div>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;裝置簡介&quot;&gt;裝置簡介&lt;/h2&gt;
&lt;p&gt;透過 4 顆 9V 電池，將筆芯接上鱷魚夾，來進行電解氯化鈉、硫酸鋅、氯化銅，並且觀察其反應。&lt;/p&gt;
&lt;img src=&quot;/2023/06/20/electrolysis/set.webp&quot; class=&quot;&quot; title=&quot;</summary>
      
    
    
    
    <category term="science" scheme="https://michaelpig0912.github.io/categories/science/"/>
    
    
    <category term="science" scheme="https://michaelpig0912.github.io/tags/science/"/>
    
    <category term="optics" scheme="https://michaelpig0912.github.io/tags/optics/"/>
    
    <category term="chemistry" scheme="https://michaelpig0912.github.io/tags/chemistry/"/>
    
  </entry>
  
  <entry>
    <title>非專業戲劇紀錄｜怪胎-音樂劇</title>
    <link href="https://michaelpig0912.github.io/2023/06/11/weirdo-musical/"/>
    <id>https://michaelpig0912.github.io/2023/06/11/weirdo-musical/</id>
    <published>2023-06-11T07:45:24.000Z</published>
    <updated>2023-09-03T11:28:13.405Z</updated>
    
    <content type="html"><![CDATA[<p style="font-size:1.5rem;color:#f55;text-align:center">注意：這是一個非專業的戲劇紀錄，僅記錄我個人的觀影經驗，並不是專業的戲劇評論。且以下的內容可能會有劇透，如果你還沒看過的話，可以先去看完再回來看這篇文章。</p><div style="width:50%;margin:auto"><img src="/2023/06/11/weirdo-musical/weirdo.webp" class="" title="怪胎海報"></div><h2 id="場域資訊">場域資訊</h2><ol><li>位置：水源劇場</li><li>票價：1990元</li><li>時間：6/10(六) 19:30~21:30</li><li>主觀評價：9/10</li></ol><h2 id="個人觀感">個人觀感</h2><ol><li>久違的去看現場的音樂劇，自從國小有一次的戶外教學是看舞台劇以後，已經很久沒有接觸現場的劇場了。</li><li>觀影體驗整體來說有到驚豔，演員張力、傳達的劇情內容、意象化的表現、音樂表現、燈光氣氛都很到位，</li><li>看完有一種原來可以這樣表現的意外感。看完以後會很遺憾沒辦法將所有的現場的感受、現場燈光、演員動作、濕度、氣味用量化的方式記錄下來，只能變成腦海中的印象。</li><li>現場燈光很好可以聚焦到演員，在畫面上不會不知道重點在哪裡。而在這種現場表演可能會跟演員對到眼，這種觀影體驗屬實特殊，不過我會習慣下意識的避開，雖然知道對方應該也無法看到台下的情況。</li><li>演員的個人魅力感覺超強的，個人超喜歡這部戲的旁白(演醫生跟內心聲音的演員)，真的會有一種被他吸引的感覺，感覺他的表演氣場甚至強過主角，會有一種期待接下來他會做什麼事情。</li><li>對於一些尺度比較大的部分，也算是刷新我對於音樂劇的認識。</li></ol><h2 id="場地心得">場地心得</h2><ol><li>舞台燈光、聲音很好，在一開始的時候有一些霧氣繚繞的感覺，在劇情中的拍照、門框舞蹈，捷運站的場景，表現讓我滿驚艷的。</li><li>水源劇場的椅子有點硬，空間有點小，有一種小時候看劇場表演的感覺(?)</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p style=&quot;font-size:1.5rem;color:#f55;text-align:center&quot;&gt;
注意：這是一個非專業的戲劇紀錄，僅記錄我個人的觀影經驗，並不是專業的戲劇評論。且以下的內容可能會有劇透，如果你還沒看過的話，可以先去看完再回來看這篇文章。&lt;/p&gt;
</summary>
      
    
    
    
    <category term="drama" scheme="https://michaelpig0912.github.io/categories/drama/"/>
    
    
    <category term="show" scheme="https://michaelpig0912.github.io/tags/show/"/>
    
    <category term="drama" scheme="https://michaelpig0912.github.io/tags/drama/"/>
    
    <category term="musical" scheme="https://michaelpig0912.github.io/tags/musical/"/>
    
  </entry>
  
  <entry>
    <title>如何使用 Google Apps Script 和 Google Sheets 做可以自動完成的表單</title>
    <link href="https://michaelpig0912.github.io/2023/06/09/googleAppScript/"/>
    <id>https://michaelpig0912.github.io/2023/06/09/googleAppScript/</id>
    <published>2023-06-09T12:38:20.000Z</published>
    <updated>2023-08-01T09:29:12.449Z</updated>
    
    <content type="html"><![CDATA[<h2 id="引言：">引言：</h2><p>最近公司想要製作一個表單，但是裡面有一欄是有關於各個學校的名稱，但是請使用者輸入可能會有不符合規定的學校名稱，因此希望有一下功能：</p><ol><li>可以有自動完成的表單，讓使用者可以選擇學校名稱。</li><li>要自動傳資料到 Google Sheets。</li><li>如果有沒有填的資料會提示被提示要填寫資料。</li><li>結束以後要有感謝語。</li></ol><p>但礙於 Google Form 沒有自動完成的功能，訪間的表單也大多數要付費，所以想說可以自己透過Google Apps Script來串 Google Sheets，做一個有自動完成的表單。</p><hr><h3 id="Google-Apps-Script-GAS-是什麼？">Google Apps Script (GAS) 是什麼？</h3><p>Google Apps Script (GAS) 是一種用於在 Google 平台上自動化和擴展 Google 應用程序的編程語言和執行環境。它是由 Google 開發，並可用於在 Google Sheets、Google Docs、Google Forms、Google Slides 和其他 Google 應用程序中編寫腳本。</p><p>使用 Google Apps Script，您可以根據自己的需求自動執行各種任務，包括生成報告、自動填寫表單、處理電子郵件、操縱數據等。它與 Google Drive 集成緊密，並且可以輕鬆訪問和操作 Google 雲端存儲中的文件和資料。</p><p>Google Apps Script 使用 JavaScript 語言，並提供了一個簡單而強大的 API 集合，用於訪問 Google應用程序的各種功能和服務。您可以通過編寫腳本來處理事件觸發、創建自定義功能、自動化工作流程等。腳本可以在瀏覽器中直接編寫和執行，也可以通過在 Google Sheets 中使用內置的腳本編輯器進行開發。</p><p>Google Apps Script 可以與 Google App Engine 配合使用，以建立更複雜的 Web 應用程序和服務。它還可以通過將腳本封裝為 Google 插件，與其他 Google 應用程序和服務進行整合。</p><p>總之，Google Apps Script 是一個方便的工具，可以通過編寫腳本來自動化和擴展 Google 應用程序的功能，使您能夠更有效地處理各種任務和自定義需求。</p><hr><h3 id="Google-Apps-Script-GAS-需要付費嗎？">Google Apps Script (GAS) 需要付費嗎？</h3><p>原則上進行一些小程式免費的應該就可以應付了，但是如果量大到一定以上的可能就需要付費購買，請見下面的連結。<a href="https://developers.google.com/apps-script/guides/services/quotas?hl=zh-tw" title="點我知道更多">Google Apps Script 額度</a></p><hr><h2 id="步驟">步驟</h2><p>接下來將會介紹如何使用 Google Apps Script 建立一個具有自動完成功能的表單，讓你能夠輕鬆收集使用者的資訊。這個表單應用程式不僅能夠減輕資料輸入的負擔，還能提供一個更好的使用者體驗，有 HTML 跟 javascript 的開發經驗的人應該可以很快上手，下面將會直接展示程式碼結構，不會一步一步建立。</p><hr><h3 id="第一步、建立-Google-Sheets">第一步、建立 Google Sheets</h3><p>首先先在 Google 雲端硬碟裡面建立一個 Google Sheets，並且點擊 <code>擴充功能</code> 裡的 <code>Apps Script</code>。</p><img src="/2023/06/09/googleAppScript/01.webp" class="" title="Google Sheets"><hr><h3 id="第二步、新增一個-HTML-檔案">第二步、新增一個 HTML 檔案</h3><p>點擊左上角的加號，新增 HTML 的檔案。</p><img src="/2023/06/09/googleAppScript/03.webp" class="" title="新增html檔案"><p><b style='color:red;'>並且將 HTML 重新命名成 Form.html (這個步驟會跟後面的程式碼有關)</b></p><hr><h3 id="第三步、將下方的-HTML-貼入">第三步、將下方的 HTML 貼入</h3><img src="/2023/06/09/googleAppScript/04.webp" class="" title="貼上 HTML"><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">base</span> <span class="attr">target</span>=<span class="string">&quot;_top&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-family</span>: Arial, sans-serif;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="number">#f5f5f5</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">form</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="number">#ffffff</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>);</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;text&quot;</span>]</span>,</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;email&quot;</span>]</span>,</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;tel&quot;</span>]</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;submit&quot;</span>]</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="number">#4CAF50</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border</span>: none;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">float</span>: right;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;submit&quot;</span>]</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="number">#45a049</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-id">#message</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="number">#dff0d8</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: <span class="number">#3c763d</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin-top</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">function</span> <span class="title function_">loadSchools</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        google.<span class="property">script</span>.<span class="property">run</span>.<span class="title function_">withSuccessHandler</span>(fillSchools).<span class="title function_">getSchools</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">function</span> <span class="title function_">fillSchools</span>(<span class="params">schools</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        $(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          $(<span class="string">&quot;#school&quot;</span>).<span class="title function_">autocomplete</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">source</span>: schools</span></span><br><span class="line"><span class="language-javascript">          &#125;);</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">function</span> <span class="title function_">submitForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> data = &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">lastName</span>: <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;lastName&#x27;</span>).<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">firstName</span>: <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;firstName&#x27;</span>).<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">city</span>: <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;city&#x27;</span>).<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">school</span>: <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;school&#x27;</span>).<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">email</span>: <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;email&#x27;</span>).<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">phone</span>: <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;phone&#x27;</span>).<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">subject</span>: <span class="title function_">getSelectedCheckboxes</span>(<span class="string">&#x27;subject&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">orderLunch</span>: <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;orderLunch&#x27;</span>).<span class="property">checked</span></span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 驗證至少選一個科目</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> checkboxes = <span class="variable language_">document</span>.<span class="title function_">getElementsByName</span>(<span class="string">&#x27;subject&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> isChecked = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; checkboxes.<span class="property">length</span>; i++) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (checkboxes[i].<span class="property">checked</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            isChecked = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">break</span>;</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (!isChecked) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">alert</span>(<span class="string">&#x27;請至少選一個科目&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        google.<span class="property">script</span>.<span class="property">run</span>.<span class="title function_">submitForm</span>(data);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;form&#x27;</span>).<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;message&#x27;</span>).<span class="property">innerText</span> = <span class="string">&#x27;感謝您的填寫！&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;message&#x27;</span>).<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;block&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="literal">false</span>;  <span class="comment">// prevent form from submitting normally</span></span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">function</span> <span class="title function_">getSelectedCheckboxes</span>(<span class="params">name</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> selectedCheckboxes = [];</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> checkboxes = <span class="variable language_">document</span>.<span class="title function_">getElementsByName</span>(name);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; checkboxes.<span class="property">length</span>; i++) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (checkboxes[i].<span class="property">checked</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            selectedCheckboxes.<span class="title function_">push</span>(checkboxes[i].<span class="property">value</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> selectedCheckboxes.<span class="title function_">join</span>(<span class="string">&#x27;, &#x27;</span>); <span class="comment">// 用逗號分開科目</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">&quot;loadSchools()&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;form&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">form</span> <span class="attr">onsubmit</span>=<span class="string">&quot;return submitForm();&quot;</span>&gt;</span></span><br><span class="line">        您的姓氏：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;lastName&quot;</span> <span class="attr">required</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        您的名字：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;firstName&quot;</span> <span class="attr">required</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        老師服務的單位縣市：</span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;city&quot;</span> <span class="attr">required</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> <span class="attr">selected</span> <span class="attr">disabled</span> <span class="attr">hidden</span>&gt;</span>請選擇縣市<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;台北市&quot;</span>&gt;</span>台北市<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;新北市&quot;</span>&gt;</span>新北市<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;桃園市&quot;</span>&gt;</span>桃園市<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 添加其他縣市選項 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        您服務的單位名稱：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;school&quot;</span> <span class="attr">required</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        您的聯絡信箱：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span> <span class="attr">id</span>=<span class="string">&quot;email&quot;</span> <span class="attr">required</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        連絡電話：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;tel&quot;</span> <span class="attr">id</span>=<span class="string">&quot;phone&quot;</span> <span class="attr">required</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        任教科目：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;subject&quot;</span> <span class="attr">value</span>=<span class="string">&quot;數學&quot;</span>&gt;</span>數學<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;subject&quot;</span> <span class="attr">value</span>=<span class="string">&quot;科學&quot;</span>&gt;</span>科學<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;subject&quot;</span> <span class="attr">value</span>=<span class="string">&quot;語文&quot;</span>&gt;</span>國文<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;subject&quot;</span> <span class="attr">value</span>=<span class="string">&quot;英文&quot;</span>&gt;</span>英文<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 添加其他科目選項 --&gt;</span></span><br><span class="line">        是否訂便當：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">id</span>=<span class="string">&quot;orderLunch&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;message&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="程式碼解釋">程式碼解釋</h4><p>這段程式碼是一個簡單的 HTML 網頁表單，用於收集使用者的基本資訊和相關選項。讓我們一步一步解釋它的結構和功能。</p><h4 id="head-區段："><code>&lt;head&gt;</code> 區段：</h4><ol><li><code>&lt;base target=&quot;_top&quot;&gt;</code>：設置基礎目標為 “_top”，這表示所有的連結點擊將在整個頁面中顯示，而不是在嵌入框架中顯示。</li><li>引入 jQuery 和 jQuery UI 的 JavaScript 檔案，以及 jQuery UI 的 CSS 樣式。</li></ol><h4 id="style-區段："><code>&lt;style&gt;</code> 區段：</h4><ol><li>定義了一些 CSS 樣式，用於設計表單和頁面的外觀，包括字型、邊距、背景顏色等。</li></ol><h4 id="script-區段："><code>&lt;script&gt;</code> 區段：</h4><ol><li><code>loadSchools()</code> 函式：在頁面載入完成後，呼叫 <code>google.script.run</code> 的 <code>getSchools()</code> 方法，並將 <code>fillSchools</code> 函式設置為成功回調函式。</li><li><code>fillSchools(schools)</code> 函式：將 <code>schools</code> 參數作為自動完成插件 <code>(autocomplete)</code> 的資料來源，並將其綁定到 id 為 “school” 的輸入框。</li><li><code>submitForm()</code> 函式：獲取表單中的各個輸入欄位的值，並將其組成一個 JavaScript 物件 data。然後，它驗證是否至少選擇了一個科目，如果沒有則顯示警示框。最後，它將 data 傳遞給 <code>google.script.run</code> 的 <code>submitForm</code> 方法，以提交表單。並隱藏表單並顯示一個感謝訊息。</li><li><code>getSelectedCheckboxes(name)</code> 函式：獲取具有指定名稱的所有被選中的核取方塊 <code>(checkbox)</code> 的值，並將其作為用逗號分隔的字符串返回。</li></ol><h4 id="body-區段："><code>&lt;body&gt;</code> 區段：</h4><ol><li><code>onload=&quot;loadSchools()&quot;</code>：在頁面載入完成後，呼叫 <code>loadSchools()</code> 函式，以初始化表單。</li><li>表單部分：包括姓名、所在縣市、所在學校、聯絡信箱、連絡電話、任教科目和是否訂便當的輸入欄位。其中，聯絡信箱和連絡電話欄位有 required 屬性，表示這些欄位必填。</li><li><code>&lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;</code>：提交按鈕，點擊後會觸發 <code>submitForm()</code> 函式。</li><li><code>&lt;div id=&quot;message&quot;&gt;&lt;/div&gt;</code>：用於顯示提交表單後的感謝訊息。</li></ol><hr><h3 id="第四步、將程式貼上程式碼-gs內">第四步、將程式貼上程式碼.gs內</h3><p>刪除一開始的 myFunction，以免報錯</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">myFunction</span>(<span class="params"></span>) &#123;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接下來將以下的程式碼貼上<code>程式碼.gs</code>內</p><img src="/2023/06/09/googleAppScript/05.webp" class="" title="貼上 程式碼.gs"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">doGet</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">//這邊的 Form 要記得跟前面的 HTML 取一樣的名稱</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">HtmlService</span>.<span class="title function_">createHtmlOutputFromFile</span>(<span class="string">&#x27;Form&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getSchools</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 這裡是一個示例數據，實際情況你可能需要從 Google Sheets 或其他地方獲取學校列表</span></span><br><span class="line">  <span class="keyword">var</span> schools = [</span><br><span class="line">    <span class="string">&#x27;學校A&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;學校B&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;學校C&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;學校D&#x27;</span></span><br><span class="line">];</span><br><span class="line">  <span class="keyword">return</span> schools;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">submitForm</span>(<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> sheet = <span class="title class_">SpreadsheetApp</span>.<span class="title function_">getActiveSpreadsheet</span>().<span class="title function_">getActiveSheet</span>();</span><br><span class="line">  sheet.<span class="title function_">appendRow</span>([data.<span class="property">lastName</span>, data.<span class="property">firstName</span>, data.<span class="property">city</span>, data.<span class="property">school</span>, data.<span class="property">email</span>, data.<span class="property">phone</span>, data.<span class="property">subject</span>, data.<span class="property">orderLunch</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="程式碼解釋-2">程式碼解釋</h4><p>這是一個 Google Apps Script 程式碼的範例，用於建立一個網頁應用程式 (Web App)。以下是程式碼中的幾個函式的解釋：</p><h4 id="doGet-函式："><code>doGet()</code> 函式：</h4><p>當 Web App 收到 GET 請求時，將執行 doGet() 函式。<br>這個函式使用 <code>HtmlService.createHtmlOutputFromFile('Form')</code> 建立並返回一個 HTML 輸出物件，該物件會顯示名為 ‘Form’ 的 HTML 檔案的內容。</p><h4 id="getSchools-函式："><code>getSchools()</code> 函式：</h4><p>這是一個自訂函式，被用作在網頁表單中的學校自動完成 (autocomplete) 功能中提供學校列表的資料來源。</p><h4 id="submitForm-data-函式："><code>submitForm(data)</code> 函式：</h4><p>這個函式用於處理表單的提交，將表單數據儲存到 Google Sheets 中。</p><ol><li>首先，它使用 <code>SpreadsheetApp.getActiveSpreadsheet().getActiveSheet()</code> 獲取目前的 Google Sheets 活頁簿和工作表。</li><li>然後，它使用 <code>sheet.appendRow()</code> 將表單數據作為一列添加到工作表中，每個數據項目對應一個欄位。</li><li>data 參數是一個包含表單數據的 JavaScript 物件，它包含姓氏、名字、城市、學校、電子郵件、電話、科目和是否訂便當的值。</li></ol><hr><h3 id="第五步、執行">第五步、執行</h3><ol><li>接下來點執行，這時候可能會跳一些需要授權或安全性的訊息，不過按繼續即可</li></ol><img src="/2023/06/09/googleAppScript/06.webp" class="" title="點擊" alt="執行"><img src="/2023/06/09/googleAppScript/07.webp" class="" title="點擊" alt="審查授權"><img src="/2023/06/09/googleAppScript/08.webp" class="" title="點擊" alt="允許"><p>接下來下面應該會看到完成的執行記錄</p><img src="/2023/06/09/googleAppScript/09.webp" class="" title="完成的執行記錄"><hr><h3 id="第六步、部屬">第六步、部屬</h3><ol><li>點擊&quot;部屬&quot;&gt;“新增部屬作業”</li></ol><img src="/2023/06/09/googleAppScript/10.webp" class="" title="部屬&gt;新增部屬作業"><ol start="2"><li>點擊&quot;齒輪&quot;&gt;“網頁應用程式”</li></ol><img src="/2023/06/09/googleAppScript/11.webp" class="" title="網頁應用程式"><ol start="3"><li>接下來設定，這邊設定成執行身份設為&quot;我&quot;<br>誰可以存取，可以依照是否要google登入之類的來決定，這邊示範是&quot;所有人&quot;都可以存取。</li></ol><img src="/2023/06/09/googleAppScript/12.webp" class="" title="設定"><ol start="4"><li>成功部屬以後就會看到一個網址，這個網址就會顯示剛剛做的網站。</li></ol><img src="/2023/06/09/googleAppScript/13.webp" class="" title="成功部屬"><hr><h3 id="第七步、網站完成驗收">第七步、網站完成驗收</h3><ol><li>點擊網址會看到剛剛做好的網站。</li></ol><img src="/2023/06/09/googleAppScript/14.webp" class="" title="成功設定好的網站"><ol start="2"><li>服務單位有做自動完成的效果。</li></ol><img src="/2023/06/09/googleAppScript/15.webp" class="" title="自動完成效果"><ol start="3"><li>少填表單會出現警示框。<br>(其他部分是使用required來強迫填寫表單)</li></ol><img src="/2023/06/09/googleAppScript/17.webp" class="" title="少填入任教科目"><img src="/2023/06/09/googleAppScript/18.webp" class="" title="跳出警示框"><ol start="4"><li>填寫完表單會出現&quot;感謝語&quot;</li></ol><img src="/2023/06/09/googleAppScript/19.webp" class="" title="感謝語"><ol start="5"><li>在原本的 Google Sheets 也會看到剛剛填寫的資料</li></ol><img src="/2023/06/09/googleAppScript/20.webp" class="" title="Google Sheets 完成效果"><hr><h3 id="網站更新與測試">網站更新與測試</h3><p>如果要更新表單，請按照以下步驟</p><ol><li>先&quot;儲存&quot; (ctrl + s)</li><li>按執行</li><li>點擊剛剛的&quot;部屬&quot;&gt;“管理部屬作業”</li></ol><img src="/2023/06/09/googleAppScript/10.webp" class="" title="管理部屬作業"><ol start="4"><li>按鉛筆&quot;編輯&quot;&gt; 建立新版本</li><li>就會部屬新的版本囉~</li></ol><hr><p>如果單純只是要測試<br>如果要更新表單，請按照以下步驟</p><ol><li>先&quot;儲存&quot; (ctrl + s)</li><li>按執行</li><li>點擊剛剛的&quot;部屬&quot;&gt;“測試部屬作業”</li></ol><img src="/2023/06/09/googleAppScript/10.webp" class="" title="測試部屬作業"><ol start="4"><li>就可以看到測試的結果囉~</li></ol><hr><h3 id="BUG">BUG</h3><p>先前在製作的時候，遇到一個奇怪的 BUG，如果 Google 內有多個帳戶登入的時候，表單就會開不起來，必須使用無痕模式才開得起來。</p><p>後來嘗試調整&quot;執行身份的設定&quot;就可以使用了。</p><img src="/2023/06/09/googleAppScript/12.webp" class="" title="設定"><hr><h2 id="結語：">結語：</h2><p>通過這個表單的例子，我們介紹了如何使用 Google Apps Script 建立一個具有自動完成功能的表單應用程式。這個應用程式不僅能夠讓你輕鬆收集群眾的資訊，還提供了良好的使用者體驗和資料管理功能。無論你是需要舉辦活動、進行調查，還是收集任何類型的資料，只要稍微修改這個表單應用程式都能夠滿足你的需求。讓我們利用自動完成功能的便利，提升資料收集的效率和準確性吧！</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;引言：&quot;&gt;引言：&lt;/h2&gt;
&lt;p&gt;最近公司想要製作一個表單，但是裡面有一欄是有關於各個學校的名稱，但是請使用者輸入可能會有不符合規定的學校名稱，因此希望有一下功能：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;可以有自動完成的表單，讓使用者可以選擇學校名稱。&lt;/li&gt;
&lt;li&gt;要自</summary>
      
    
    
    
    <category term="code" scheme="https://michaelpig0912.github.io/categories/code/"/>
    
    
    <category term="code" scheme="https://michaelpig0912.github.io/tags/code/"/>
    
    <category term="Google Apps Script" scheme="https://michaelpig0912.github.io/tags/Google-Apps-Script/"/>
    
    <category term="javascript" scheme="https://michaelpig0912.github.io/tags/javascript/"/>
    
    <category term="html" scheme="https://michaelpig0912.github.io/tags/html/"/>
    
  </entry>
  
  <entry>
    <title>鏡子竟然會反射被遮擋的物體?!</title>
    <link href="https://michaelpig0912.github.io/2023/04/12/mirrorAndPaper/"/>
    <id>https://michaelpig0912.github.io/2023/04/12/mirrorAndPaper/</id>
    <published>2023-04-11T17:10:03.000Z</published>
    <updated>2023-04-13T16:52:42.432Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>先前在滑手機的時候，看見網路上瘋傳一個違反直覺的光學現象，有人拿將紙放在鏡子前面，並且放物體在上面，如下圖所示。</p><img src="/2023/04/12/mirrorAndPaper/demoMerror.webp" class="" title="概念演示"><p>根據一般的認知，物體被紙張遮擋後，<font color=#F55>在鏡子中的成像應該被阻擋而看不見。</font><br>然而，實際情況卻是<font color=#F55>鏡子能夠反射出紙張後面的物體</font>。究竟是什麼原理呢？</p><h2 id="解釋">解釋</h2><h3 id="看到物體的原理">看到物體的原理</h3><p>要理解這個現象，我們首先需要了解人眼觀察物體的原理。人眼之所以能看到物體，實際上是因為物體在光源照射下，表面的光線會向各個方向反射。當這些反射光線進入眼睛後，視網膜將其轉換為電子訊號，再傳遞至大腦，這時大腦通常會將光線沿著直線路徑回溯到物體的表面，從而構建出一個立體影像，讓我們可以判別物體的位置。如下圖所示：</p><img src="/2023/04/12/mirrorAndPaper/mirrorAndPaper01.webp" class="" title="眼睛看到東西的概念"><p>( 註：這張圖為簡化版，實際上物體的表面會有無數光線散發，這裡僅繪製物體上的一個點。 )</p><h3 id="看到反射的物體">看到反射的物體</h3><p>而當光線從物體反射到鏡子表面，並再次反射進入我們的眼睛時，這時光線的路徑會因為鏡子反射發生變化。導致我們的大腦覺得物體好像在鏡子裡面一樣。</p><p>這種錯覺的產生主要是因為鏡子反射光線的方式。當物體上的光線反射到鏡子表面時，我們的大腦會根據習慣，沿著光線的直線路徑回溯。因此，我們看到的物體影像似乎是在鏡子裡面，而不是它們真正所在的位置。如下圖所示：</p><img src="/2023/04/12/mirrorAndPaper/mirrorAndPaper02.webp" class="" title="眼睛看到鏡子內的東西"><h3 id="紙張後物體可見原因">紙張後物體可見原因</h3><p>鏡子前放置紙張，而物體位於紙張後方，而我們依然能看到物體的原因在於光的反射作用。由於觀察角度足夠傾斜，物體表面的光線可以經過鏡子反射並進入眼睛。如下圖所示：</p><img src="/2023/04/12/mirrorAndPaper/mirrorAndPaper03.webp" class="" title="看的到紙後物體的原因"><p>然而，如果我們改變位置，使物體無法反射到鏡子內的光線，我們就無法看到該物體了。如下圖所示：</p><img src="/2023/04/12/mirrorAndPaper/mirrorAndPaper04.webp" class="" title="換著角度就會看不到了"><h2 id="總結">總結</h2><p>這個看似違反直覺的光學現象可以通過光的反射來解釋。當觀察角度足夠傾斜時，物體後方的光線仍可以通過鏡子反射進入我們的眼睛，使我們能夠看到被紙張遮擋的物體。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;前言&lt;/h2&gt;
&lt;p&gt;先前在滑手機的時候，看見網路上瘋傳一個違反直覺的光學現象，有人拿將紙放在鏡子前面，並且放物體在上面，如下圖所示。&lt;/p&gt;
&lt;img src=&quot;/2023/04/12/mirrorAndPaper/demoMerror.webp&quot; cl</summary>
      
    
    
    
    <category term="science" scheme="https://michaelpig0912.github.io/categories/science/"/>
    
    
    <category term="science" scheme="https://michaelpig0912.github.io/tags/science/"/>
    
    <category term="optics" scheme="https://michaelpig0912.github.io/tags/optics/"/>
    
    <category term="physics" scheme="https://michaelpig0912.github.io/tags/physics/"/>
    
  </entry>
  
  <entry>
    <title>Asus TUF F15 FX506HM 升級 SSD：簡單步驟就可以升級 SSD ！</title>
    <link href="https://michaelpig0912.github.io/2023/04/05/ASUSfx506hm_UpgradeSSD/"/>
    <id>https://michaelpig0912.github.io/2023/04/05/ASUSfx506hm_UpgradeSSD/</id>
    <published>2023-04-05T07:46:19.000Z</published>
    <updated>2023-04-05T12:38:08.585Z</updated>
    
    <content type="html"><![CDATA[<p>最近因為 AI 的各種應用的興起，像是 stable diffusion 或是聲音模仿的 AI 程式，但由於訓練 AI 模型時通常需要大量的數據儲存和高速讀取，再加上最近 SSD 價格有變得先前比較便宜一點，因此我決定將筆電來升級一下。在本文中將重點介紹 FX506HM 要如何升級 SSD 和注意事項。</p><h2 id="筆電與-SSD-規格">筆電與 SSD 規格</h2><ol><li>筆電：Asus TUF F15 FX506HM (i7-11800版本)</li><li>SSD：美光Micron Crucial P5 Plus 1TB<br>a. 價格：2450 元 (原價屋)<br>b. 規格：M.2 PCIe 2280、TLC顆粒<br>c. 讀: 6600 MB/s / 寫: 5000 MB/s<img src="/2023/04/05/ASUSfx506hm_UpgradeSSD/cover.webp" class="" title="SSD 外盒"><img src="/2023/04/05/ASUSfx506hm_UpgradeSSD/SSD.webp" class="" title="SSD 本體"></li></ol><p><font color=#F55>※ 請注意：雖然此 SSD 支援 PCIe 4.0，但 Asus TUF F15 FX506HM 只支援到 PCIe 3.0，因此在後面的測試中會看到這個硬碟的速度讀取會卡在 3000 MB/s 左右，因此建議可以選擇 PCIe 3.0 SSD 就可以了。</font></p><h2 id="警語">警語</h2><p>在進行筆電拆機升級時，請確保您具備相關經驗和技能。如若不熟悉硬體操作，建議尋求專業人士的幫助，以免對筆電造成損壞。請謹慎操作，確保升級過程安全無虞。</p><h2 id="步驟">步驟</h2><ol><li>為了拆開筆電背蓋，請先將電腦關機，並拔掉電源。</li><li>筆電背蓋共有11個螺絲，並且長短不一。<img src="/2023/04/05/ASUSfx506hm_UpgradeSSD/pcCover.webp" class="" title="筆電的螺絲孔位置，請注意左上角的螺絲是拆不下來的"><img src="/2023/04/05/ASUSfx506hm_UpgradeSSD/screw.webp" class="" title="螺絲長短不一"></li><li>位於左上角的螺絲是固定在蓋板上的，可以轉鬆但拆不下來。<img src="/2023/04/05/ASUSfx506hm_UpgradeSSD/screwIn.webp" class="" title="拆不下來的螺絲內部"><img src="/2023/04/05/ASUSfx506hm_UpgradeSSD/screwOut.webp" class="" title="拆不下來的螺絲外部"></li><li>使用塑膠的撬棒等工具，沿著筆電機殼邊緣輕輕撬開，直至取下蓋板。<img src="/2023/04/05/ASUSfx506hm_UpgradeSSD/pcOverviwe.webp" class="" title="拆開背蓋後會看到裡面的電路板"></li><li>在安裝新 SSD 之前，務必先確保筆電已斷電，因此要先拔掉筆電的電池。<img src="/2023/04/05/ASUSfx506hm_UpgradeSSD/power.webp" class="" title="請先取下這邊的電源排線"></li><li>找到 SSD 的插槽，但可能會需要先把附近的喇叭排線拔掉，接著再將 SSD 螺絲取下。</li><li>安裝 SSD 時確保其與插槽對齊，然後用螺絲將其鎖緊。<img src="/2023/04/05/ASUSfx506hm_UpgradeSSD/pcWithSSD.webp" class="" title="SSD 安裝"></li><li>接著將剛剛移除的喇叭排線與電源插上，在這個過程中請小心，可能會產生火花。</li><li>重新將蓋板蓋上，並將之前拆下的螺絲依順序鎖回原位。</li><li>開機後，進入「磁碟管理」，將看到一個全新未分割的 SSD ，接著就是做磁碟分割跟格式化後，就完成安裝了。<img src="/2023/04/05/ASUSfx506hm_UpgradeSSD/SSDintall.webp" class="" title="「磁碟管理」中看到有讀取到"></li></ol><h2 id="參數">參數</h2><p>這邊使用 CrystalDiskMark 來測試硬碟速度，但讀取速度都卡在 3000 MB/s，但是理論上這個 SSD 讀取是可以跑到 6600 MB/s，這個差別可能是因為這台筆電只能支援到 PCIe 3.0，所以限縮了這個 SSD 的速度。</p><img src="/2023/04/05/ASUSfx506hm_UpgradeSSD/CrystalDiskMark.webp" class="" title="用CrystalDiskMark看硬碟跑分">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;最近因為 AI 的各種應用的興起，像是 stable diffusion 或是聲音模仿的 AI 程式，但由於訓練 AI 模型時通常需要大量的數據儲存和高速讀取，再加上最近 SSD 價格有變得先前比較便宜一點，因此我決定將筆電來升級一下。在本文中將重點介紹 FX506HM 要</summary>
      
    
    
    
    <category term="unbox" scheme="https://michaelpig0912.github.io/categories/unbox/"/>
    
    
    <category term="unbox" scheme="https://michaelpig0912.github.io/tags/unbox/"/>
    
    <category term="pc" scheme="https://michaelpig0912.github.io/tags/pc/"/>
    
  </entry>
  
  <entry>
    <title>簡單易用！免費圖片轉 WebP 工具，提高網站 SEO 效果！</title>
    <link href="https://michaelpig0912.github.io/2023/04/04/OnlineImage2WebP/"/>
    <id>https://michaelpig0912.github.io/2023/04/04/OnlineImage2WebP/</id>
    <published>2023-04-04T14:07:06.000Z</published>
    <updated>2023-04-05T16:24:00.466Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>WebP 是一種由 Google 開發的圖像檔案格式，使用 WebP 可以減少圖像的檔案大小，同時保留圖像的品質，進而加速網站的載入速度。然而，許多線上的圖片轉換工具都無法支援 WebP 的格式，因此本文將介紹一個自製的線上圖片轉 WebP 的小工具，如果你想要使用 WebP 格式的圖片來優化你的網站，這個小工具絕對值得一試。</p><h2 id="小工具網站">小工具網站</h2><p>  <font size=4pt><strong><a href="/sideProject/image2WebP/image2WebP.html">◉ 點我前往 WebP 小工具ヾ(•ω•`)o</a></strong></font></p><h2 id="如何使用">如何使用</h2><img src="/2023/04/04/OnlineImage2WebP/demo.webp" class="" title="基本說明"><p>使用這個小工具非常簡單，只需要依照以下步驟：</p><ol><li>先設定圖像轉換後的「解析度」和「壓縮品質」。<br>a. 「解析度」越高代表圖像損失會越少，反之亦然。<br>b. 「壓縮品質」越大代表圖像損失會越少，反之亦然。</li><li>點選「選擇圖片檔案」按鈕，選擇要轉換的圖像檔案，可以選擇<strong>多個檔案</strong>。</li><li>點選「下載」按鈕，下載單張圖片內容。</li><li>點選「下載轉換完成的檔案」按鈕，下載轉換後的全部圖像檔案。</li></ol><h2 id="程式碼說明">程式碼說明</h2><p>本程式碼是一個基於 HTML、CSS 和 JavaScript 的網頁應用程式，可以將選擇的圖像檔案轉換成 WebP 的格式。以下是程式碼的一些要點：</p><ol><li>使用 HTML 的 input 元素來讓使用者選擇要轉換的圖像檔案。</li><li>使用 JavaScript 和 JSZip 函式庫來處理圖像檔案，並將轉換後的圖像添加到 ZIP 檔案中。</li><li>使用 HTML 和 CSS 來顯示轉換後的圖像縮略圖，並提供下載的按鈕。</li><li>提供使用者可以設定轉換後圖像的解析度和壓縮品質。</li></ol><p>  <font size=4pt><strong><a href="https://github.com/michaelpig0912/OnlineImage2WebP">◉ 詳細的程式碼請見githubヾ(•ω•`)o</a></strong></font></p><h2 id="程式內部的功能說明">程式內部的功能說明</h2><ol><li>handleFileSelect(event)：此函數負責處理文件選擇，當用戶選擇圖像文件時會觸發。它將遍歷選擇的所有文件，並將每個文件轉換為 WebP 格式。轉換完成後，它將結果存儲在 cachedResults Map 中並顯示結果。</li><li>updateResults()：此函數用於更新結果。當用戶更改解析度或壓縮品質時，它會清除畫面上的結果並從 cachedResults Map 中重新計算並顯示結果。</li><li>convertToWebP(file)：此函數接收一個圖像文件作為參數，將其轉換為 WebP 格式。它會根據用戶設定的解析度和壓縮品質進行轉換，並返回一個包含轉換後的圖像 blob，以及圖像的寬度和高度的物件。</li><li>showResult(blob, fileName, width, height)：此函數負責將結果顯示在畫面上。它接收轉換後的圖像 blob、文件名、寬度和高度作為參數。它將圖像添加到 zip 檔案中，並創建一個縮略圖容器，包含圖像縮略圖、文件名、文件大小、解析度和一個用於下載單個轉換圖像的按鈕。最後，它將縮略圖容器添加到畫面上的結果區域。</li><li>clearResults()：此函數用於清除畫面上的結果。它將結果區域的內容設置為空，並禁用下載按鈕。</li></ol><h2 id="結論">結論</h2><p>本篇文章介紹了自製線上圖片轉 WebP 的小工具，此工具除了提供圖片轉換功能外，還具有幾個 SEO 優點。首先，WebP 可以有效地減少圖像檔案的大小，進而提高網站的載入速度，對於使用者的體驗有所幫助；其次，本小工具的程式碼是基於 HTML、CSS 和 JavaScript 撰寫，相容於各種瀏覽器，不需要安裝任何軟體，使用上非常方便。希望本文可以幫助需要將圖片轉換為 WebP 格式的使用者，加速網站的載入速度，提高使用者的體驗。但要注意的是，本工具目前暫不支援 HEIC 格式的圖像檔案，使用者需注意檔案的格式。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;前言&lt;/h2&gt;
&lt;p&gt;WebP 是一種由 Google 開發的圖像檔案格式，使用 WebP 可以減少圖像的檔案大小，同時保留圖像的品質，進而加速網站的載入速度。然而，許多線上的圖片轉換工具都無法支援 WebP 的格式，因此本文將介紹一個自製的線上圖片轉 W</summary>
      
    
    
    
    <category term="code" scheme="https://michaelpig0912.github.io/categories/code/"/>
    
    
    <category term="code" scheme="https://michaelpig0912.github.io/tags/code/"/>
    
    <category term="javascript" scheme="https://michaelpig0912.github.io/tags/javascript/"/>
    
    <category term="html" scheme="https://michaelpig0912.github.io/tags/html/"/>
    
    <category term="SEO" scheme="https://michaelpig0912.github.io/tags/SEO/"/>
    
  </entry>
  
  <entry>
    <title>如何使用 Python 將圖片轉換成 WebP</title>
    <link href="https://michaelpig0912.github.io/2023/04/04/imageToWebP/"/>
    <id>https://michaelpig0912.github.io/2023/04/04/imageToWebP/</id>
    <published>2023-04-04T07:38:22.000Z</published>
    <updated>2023-04-04T17:09:04.253Z</updated>
    
    <content type="html"><![CDATA[<h2 id="使用-Python-快速輕鬆地將-HEIC、JPG、PNG-轉換為-WebP">使用 Python 快速輕鬆地將 HEIC、JPG、PNG 轉換為 WebP</h2><p>當我們在製作網頁時，通常需要大量的圖片，但是網頁的載入速度會因為圖片的大小而變慢，進而導致 SEO 的分數變差。 WebP 是一種由 Google 推出的圖片格式，可以有效地減小圖片的大小，同時也保持了圖片的品質。在這篇文章中，我們會使用 Python 來將 HEIC、JPG、JPEG 和 PNG 格式的照片轉換成 WebP 格式，並且移除其中的照片資訊，以保護個人隱私。</p><h2 id="安裝依賴庫">安裝依賴庫</h2><p>Pillow 是一個 Python 圖像處理庫，而 pillow-heif 是一個 Pillow 套件，可以處理 HEIF 格式的圖片。要使用這個套件，請在命令行中輸入以下指令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pillow pillow-heif</span><br></pre></td></tr></table></figure><h2 id="程式">程式</h2><p>這個程式會先從指定的目錄中，尋找 HEIC、JPG、JPEG 和 PNG 格式的照片，並且使用 Pillow 來將它們轉換成 WebP 格式。<br>也會同時移除照片中的 EXIF 資訊。</p><p>這個程式的主要要達到的功能有三個：</p><ol><li>想要將 HEIC、JPG、JPEG 轉換為 WebP ，並且解析度不更改，檔名也維持一樣。</li><li>將想要轉換的 HEIC、JPG、JPEG 檔案放在與程式相同位置的 <code>/image</code> 資料夾下，並且輸出的檔案在同一資料夾內。</li><li>移除其中的 EXIF 資訊。</li></ol><p>接下來是程式碼的說明，</p><ol><li>程式的主要流程是使用<code>os.walk</code>函數遍歷圖片資料夾中的所有檔案，判斷檔案類型是否為 heic、jpg、jpeg 或 png，如果是就呼叫 convert_to_webp 函數進行轉換。</li><li><code>convert_to_webp</code>函數中，我們首先使用Pillow套件的<code>Image.open</code>函數讀取圖片檔案，然後將其轉換為 RGB 模式，因為 WebP 不支援其他模式的圖片。</li><li>接著，我們使用<code>Image.getexif</code>函數獲取圖片的exif資訊，如果有 EXIF 資訊，則轉換為 bytes 類型，否則為空 bytes。</li><li>最後，我們使用<code>Image.save</code>函數將轉換後的圖片儲存為 WebP 格式，設置品質為 80，並移除 EXIF 資訊。</li><li>如果轉換成功，就輸出成功訊息，否則輸出錯誤訊息。</li><li>最後加上判斷程式是否作為主程式執行的判斷，如果是，就呼叫<code>main</code>函數，這樣在執行這個程式的時候，就可以自動遍歷指定的資料夾，並轉換所有符合條件的圖片檔案了。</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> pillow_heif <span class="keyword">import</span> register_heif_opener</span><br><span class="line"></span><br><span class="line">register_heif_opener()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert_to_webp</span>(<span class="params">input_file, output_file</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        img = Image.<span class="built_in">open</span>(input_file)</span><br><span class="line">        img = img.convert(<span class="string">&quot;RGB&quot;</span>)</span><br><span class="line">        exif_data = img.getexif()</span><br><span class="line">        <span class="keyword">if</span> exif_data:</span><br><span class="line">            exif_bytes = exif_data.tobytes()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            exif_bytes = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        img.save(output_file, <span class="string">&quot;webp&quot;</span>, quality=<span class="number">80</span>, exif=exif_bytes)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Successfully converted <span class="subst">&#123;input_file&#125;</span> to <span class="subst">&#123;output_file&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error converting <span class="subst">&#123;input_file&#125;</span> to <span class="subst">&#123;output_file&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    script_directory = os.path.dirname(os.path.abspath(__file__))</span><br><span class="line">    input_directory = os.path.join(script_directory, <span class="string">&quot;image&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> root, _, files <span class="keyword">in</span> os.walk(input_directory):</span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">            file_ext = os.path.splitext(file.lower())[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> file_ext <span class="keyword">in</span> (<span class="string">&#x27;.heic&#x27;</span>, <span class="string">&#x27;.jpg&#x27;</span>, <span class="string">&#x27;.jpeg&#x27;</span>, <span class="string">&#x27;.png&#x27;</span>):</span><br><span class="line">                input_file = os.path.join(root, file)</span><br><span class="line">                output_file = os.path.splitext(input_file)[<span class="number">0</span>] + <span class="string">&quot;.webp&quot;</span></span><br><span class="line">                convert_to_webp(input_file, output_file)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h2 id="運行程式">運行程式</h2><p>要使用此程式，請按照以下步驟操作：</p><ol><li>確保已經安裝了 Python 以及 Pillow 和 pillow-heif 。</li><li>將上述程式儲存為名為 <code>convert_to_webp.py</code>。</li><li>在程式所在的目錄下創建一個名為 image 的文件夾，將想要轉換的圖片放入該文件夾中。</li><li>打開命令列 ( CMD )，進入至程式所在的目錄，然後運行以下命令：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python heic_to_jpg.py</span><br></pre></td></tr></table></figure><ol start="5"><li>程式將自動尋找<code>/image</code>文件夾中的所有圖片，並將其轉換為 WebP 。</li><li>轉換後的 WebP 文件將與原來的 HEIC 圖片的相同的文件夾中。</li></ol><h2 id="結論">結論</h2><p>總結來說，這個程式可以幫助想要使用 WebP 來縮小網頁圖片的人，並且移除其中的照片資訊，避免暴露個資的需求。使用這個程式，讀者可以輕鬆地將自己的圖片轉換為 WebP 格式，從而提升網頁載入速度和用戶體驗。注意，這個程式僅支援HEIC、JPG、JPEG 和 PNG 格式的圖片，如果要轉換其他格式的圖片，需要修改程式碼。希望這篇說明文能夠幫助讀者理解這個程式的作用和使用方法，如果有任何問題或建議，歡迎在下方留言。</p><h2 id="Windows可直接用的exe檔案">Windows可直接用的exe檔案</h2><p>本次的內容有打包好的檔案，因此就不用額外用 Python 和安裝東西，下載<a href="https://github.com/michaelpig0912/image2WebP/releases">此github上的內容</a>，並且解壓縮。接著會看到裡面有幾個檔案，如下圖所示。</p><img src="/2023/04/04/imageToWebP/Packageimage2WebP.webp" class="" title="打包好的檔案"><ol><li>將 HEIC 圖片放入<code>/image</code>的資料夾內。</li><li>點擊&quot;image2WebP.exe&quot;</li><li>再進入<code>/image</code>的資料夾內，即可看到轉成 WebP 的檔案。</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;使用-Python-快速輕鬆地將-HEIC、JPG、PNG-轉換為-WebP&quot;&gt;使用 Python 快速輕鬆地將 HEIC、JPG、PNG 轉換為 WebP&lt;/h2&gt;
&lt;p&gt;當我們在製作網頁時，通常需要大量的圖片，但是網頁的載入速度會因為圖片的大小而變慢，進而導致</summary>
      
    
    
    
    <category term="code" scheme="https://michaelpig0912.github.io/categories/code/"/>
    
    
    <category term="code" scheme="https://michaelpig0912.github.io/tags/code/"/>
    
    <category term="SEO" scheme="https://michaelpig0912.github.io/tags/SEO/"/>
    
    <category term="python" scheme="https://michaelpig0912.github.io/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>如何使用 Python 將 HEIC 轉換為 JPG</title>
    <link href="https://michaelpig0912.github.io/2023/04/03/heicTojpg/"/>
    <id>https://michaelpig0912.github.io/2023/04/03/heicTojpg/</id>
    <published>2023-04-03T13:28:14.000Z</published>
    <updated>2023-04-04T17:05:41.041Z</updated>
    
    <content type="html"><![CDATA[<h2 id="使用-Python-快速輕鬆地將-HEIC-轉換為-JPG">使用 Python 快速輕鬆地將 HEIC 轉換為 JPG</h2><p>HEIC 格式是一種由 Apple 推廣的高效圖像格式，它具有更好的壓縮效果和更高的影像品質。但儘管 HEIC 格式在 Apple 設備上廣泛使用，但在其他平台（如 Windows 和 Android）上仍然存在一些兼容性問題，這使得許多用戶在想要分享 HEIC 圖片時感到困擾。</p><p>本文將介紹如何使用 Python 編寫一個簡單的程式，將 HEIC 格式的圖片輕鬆快速地轉換為更通用的 JPG 格式。我們將使用 Pillow 和 pillow-heif 來解決這個問題。而會選擇 pillow-heif 的原因，是因為原先想要在 windows 系統安裝 pyheif ，但是發現很多問題導致裝不起來，因此才會改用 pillow-heif 。</p><h2 id="安裝依賴庫">安裝依賴庫</h2><p>首先，我們需要安裝 Pillow 和 pillow-heif ，打開命令列並運行以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install Pillow pillow-heif</span><br></pre></td></tr></table></figure><h2 id="程式">程式</h2><p>這個程式的主要要達到的功能有兩個</p><ol><li>想要將 HEIC 轉換為 JPG ，並且解析度不更改，檔名也維持一樣。</li><li>將想要轉換的 HEIC 檔案放在與程式相同位置的 <code>/image</code> 資料夾下。</li></ol><p>接下來，請參考以下的 Python 程式碼。該程式中，</p><ol><li>包含一個名為 <code>convert_to_jpg</code> 的函數，用於將 HEIC 文件轉換為 JPG 文件。</li><li>另一個 <code>main</code> 函數負責查找 image 文件夾中的所有 HEIC 文件並對其進行轉換。</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> pillow_heif <span class="keyword">import</span> register_heif_opener</span><br><span class="line"></span><br><span class="line">register_heif_opener()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert_to_jpg</span>(<span class="params">input_file, output_file</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        img = Image.<span class="built_in">open</span>(input_file)</span><br><span class="line">        img = img.convert(<span class="string">&quot;RGB&quot;</span>)</span><br><span class="line">        img.save(output_file, <span class="string">&quot;JPEG&quot;</span>, quality=<span class="number">95</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Successfully converted <span class="subst">&#123;input_file&#125;</span> to <span class="subst">&#123;output_file&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error converting <span class="subst">&#123;input_file&#125;</span> to <span class="subst">&#123;output_file&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    script_directory = os.path.dirname(os.path.abspath(__file__))</span><br><span class="line">    input_directory = os.path.join(script_directory, <span class="string">&quot;image&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> root, _, files <span class="keyword">in</span> os.walk(input_directory):</span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">            file_ext = os.path.splitext(file.lower())[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> file_ext == <span class="string">&#x27;.heic&#x27;</span>:</span><br><span class="line">                input_file = os.path.join(root, file)</span><br><span class="line">                output_file = os.path.splitext(input_file)[<span class="number">0</span>] + <span class="string">&quot;.jpg&quot;</span></span><br><span class="line">                convert_to_jpg(input_file, output_file)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h2 id="運行程式">運行程式</h2><p>要使用此程式，請按照以下步驟操作：</p><ol><li>確保已經安裝了 Python 以及 Pillow 和 pillow-heif 庫。</li><li>將上述程式儲存為名為 heic_to_jpg.py 的文件。</li><li>在程式所在的目錄下創建一個名為 image 的文件夾，將想要轉換的 HEIC 圖片放入該文件夾中。</li><li>打開命令列 ( CMD )，進入至程式所在的目錄，然後運行以下命令：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python heic_to_jpg.py</span><br></pre></td></tr></table></figure><p>程式將自動尋找 <code>/image</code> 文件夾中的所有 HEIC 文件並將其轉換為 JPG 文件。轉換後的 JPG 文件將與原來的 HEIC 圖片的相同的文件夾中。</p><h2 id="結論">結論</h2><p>這次我們介紹如何使用 Python 和 Pillow，將 HEIC 圖片轉換為 JPG 格式。這是一個簡單但實用的程式，可以方便地將 HEIC 圖片轉換為更通用的 JPG 格式。如果您有任何問題或想了解更多關於 Python 圖像處理的信息，請隨時在評論區提問！</p><h2 id="擴展功能">擴展功能</h2><p>雖然我們在這篇文章中主要關注將 HEIC 轉換為 JPG，但您還可以使用類似的方法將 HEIC 文件轉換為其他圖像格式，如 webp。您還可以使用 Pillow 庫進行更高級的影像處理，例如調整影像大小、應用濾鏡和編輯影像的資料數據等。</p><h2 id="Windows可直接用的exe檔案">Windows可直接用的exe檔案</h2><p>本次的內容有打包好的檔案，因此就不用額外用 python 和安裝東西，下載<a href="https://github.com/michaelpig0912/heic2jpg/releases">此 github 上的內容</a>，並且解壓縮。接著會看到裡面有幾個檔案，如下圖所示。</p><img src="/2023/04/03/heicTojpg/PackageHeic2Jpg.webp" class="" title="打包好的檔案"><p>接著按照底下步驟操作：</p><ol><li>將 HEIC 圖片放入<code>/image</code>的資料夾內。</li><li>點擊&quot;heic2jpg.exe&quot;</li><li>再進入<code>/image</code>的資料夾內，即可看到轉成 JPG 的檔案。</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;使用-Python-快速輕鬆地將-HEIC-轉換為-JPG&quot;&gt;使用 Python 快速輕鬆地將 HEIC 轉換為 JPG&lt;/h2&gt;
&lt;p&gt;HEIC 格式是一種由 Apple 推廣的高效圖像格式，它具有更好的壓縮效果和更高的影像品質。但儘管 HEIC 格式在 App</summary>
      
    
    
    
    <category term="code" scheme="https://michaelpig0912.github.io/categories/code/"/>
    
    
    <category term="code" scheme="https://michaelpig0912.github.io/tags/code/"/>
    
    <category term="python" scheme="https://michaelpig0912.github.io/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>設計蝕刻控制器</title>
    <link href="https://michaelpig0912.github.io/2023/02/14/etchedSmallController/"/>
    <id>https://michaelpig0912.github.io/2023/02/14/etchedSmallController/</id>
    <published>2023-02-13T16:32:34.000Z</published>
    <updated>2023-04-04T19:20:31.979Z</updated>
    
    <content type="html"><![CDATA[<h2 id="簡介">簡介</h2><h3 id="設計條件">設計條件</h3><p>剛好有朋友找我設計一個他們實驗要用的裝置，想要做到的效果。</p><ol><li>有一個主要迴路，上面有恆定的電壓，大約 7 V。</li><li>需要用 Arduino 來測量其電流，電流值約在 10~20 mA 左右。</li><li>如果蝕刻發生變化時，電流會瞬間掉到 3 mA左右，這時主要迴路要變成斷路。</li><li>但蝕刻的時候電壓也會稍微變小，從 20 mA 掉落到 10 mA 左右。</li></ol><h3 id="大概的思考架構如圖所示">大概的思考架構如圖所示</h3><img src="/2023/02/14/etchedSmallController/draft.webp" class="" title="草稿"><p>本裝置是透過 ina219 來測量為小電流，<br>可以支援量測到 26 V，<br>並且搭配一個 5V relay，<br>如果電流瞬間下降時，<br>就透過 relay 來切斷主迴路的電源，<br>透過不同顏色的 LED 或 OLED 螢幕來顯示現在電路狀況。</p><h3 id="實際圖片">實際圖片</h3><img src="/2023/02/14/etchedSmallController/demo1.webp" class="" title="組合好的樣子"><img src="/2023/02/14/etchedSmallController/demo2.webp" class="" title="內部構造"><p>操作實際影片<br><video width="100%" height="100%"  src="./videoDemo.mp4" controls></video></p><hr><h2 id="所需材料與架構">所需材料與架構</h2><ol><li>Arduino UNO</li><li>INA219<ul><li>使用 I2C 介面</li><li>工作電壓 +3.0 至 +5.5V 之間</li><li>溫度範圍(可實現 1% 的最大誤差精度) -40C 至 +85C</li><li>分辨率 12 位元</li><li>電壓範圍為 0 V 至 +26 V</li><li>以安培為單位讀取電流，並以瓦特為單位讀取電源</li><li>對多達 128 個採樣求平均值</li></ul></li><li>5V relay</li><li>power supply (蝕刻用)</li><li>不同顏色的 LED</li><li>0.96 寸 OLED 螢幕</li></ol><hr><h2 id="注意事項">注意事項</h2><ol><li>透過 INA219 測量電流。</li><li>透過 Arudino 來控制 relay 是否要導通。</li><li>一旦迴圈成立後， Arduino 會一直循環執行斷開 relay 。</li><li>但如果電流突然 drop 很多 像一個 step function 瞬間跳掉變不同的值（不是連續變化的）這時候就瞬間不輸出電壓。</li><li>全部設定好以後，再接上 Arduino 的電源。</li><li>如果Arduino<strong>未通電</strong>時，<strong>relay 預設為接通</strong>。</li></ol><hr><h2 id="標準流程：">標準流程：</h2><ol><li>先將線路全部接好，先不要通電。</li><li>將電源供應器打開到指定電壓。</li><li>電壓和電流穩定後，再將 Arduino 通電。</li><li>開始蝕刻。</li><li>有大幅度電流下降， relay 跳開。</li><li>將電源供應器關閉。</li><li>將 Arduino 斷電。</li></ol><hr><h2 id="程式碼與邏輯">程式碼與邏輯</h2><h3 id="程式碼邏輯">程式碼邏輯</h3><p><a href="https://whimsical.com/arduino-6houbpN4HPXpyc9pzqHUbs">https://whimsical.com/arduino-6houbpN4HPXpyc9pzqHUbs</a></p><h3 id="無螢幕版本">無螢幕版本</h3><p>需要下載 Adafruit_INA219 庫</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Wire.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Adafruit_INA219.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">float</span> lastCurrent_mA= <span class="number">0</span> ;</span><br><span class="line"><span class="comment">//上一次的電流值(全域變數)，注意：一開始是設定為0，因此當有電流值時(假設 20 mA)，</span></span><br><span class="line"><span class="comment">//下面會執行 20-0=20 ，因此不會斷路，但如果是突然斷路大於 3 mA 時，relay 會保持斷路。</span></span><br><span class="line"><span class="type">float</span> currentSub = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//這個變數是本次與上次電流相減的值</span></span><br><span class="line">Adafruit_INA219 ina219;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">begin</span>(<span class="number">9600</span>);</span><br><span class="line"></span><br><span class="line">  <span class="type">uint32_t</span> currentFrequency;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot;Hello!&quot;</span>);</span><br><span class="line">  <span class="built_in">pinMode</span>(<span class="number">4</span>, <span class="literal">OUTPUT</span>);</span><br><span class="line">  <span class="built_in">pinMode</span>(<span class="number">2</span>, <span class="literal">OUTPUT</span>);</span><br><span class="line">  <span class="built_in">pinMode</span>(<span class="number">3</span>, <span class="literal">OUTPUT</span>);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(<span class="number">4</span>, <span class="literal">LOW</span>);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(<span class="number">2</span>, <span class="literal">LOW</span>);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(<span class="number">3</span>, <span class="literal">LOW</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">Wire</span>.<span class="built_in">begin</span>();</span><br><span class="line">  ina219.<span class="built_in">begin</span>();</span><br><span class="line">  <span class="comment">//ina219.setCalibration_32V_1A();</span></span><br><span class="line">  ina219.<span class="built_in">setCalibration_16V_400mA</span>();</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot;Measuring voltage and current with INA219 ...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">float</span> shuntvoltage = <span class="number">0</span>;</span><br><span class="line">  <span class="type">float</span> busvoltage = <span class="number">0</span>;</span><br><span class="line">  <span class="type">float</span> current_mA = <span class="number">0</span>;</span><br><span class="line">  <span class="type">float</span> loadvoltage = <span class="number">0</span>;</span><br><span class="line">  <span class="type">float</span> power_mW = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  shuntvoltage = ina219.<span class="built_in">getShuntVoltage_mV</span>();</span><br><span class="line">  busvoltage = ina219.<span class="built_in">getBusVoltage_V</span>();</span><br><span class="line">  current_mA = ina219.<span class="built_in">getCurrent_mA</span>();</span><br><span class="line">  power_mW = ina219.<span class="built_in">getPower_mW</span>();</span><br><span class="line">  loadvoltage = busvoltage + (shuntvoltage / <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">print</span>(<span class="string">&quot;Bus Voltage:   &quot;</span>); <span class="built_in">Serial</span>.<span class="built_in">print</span>(busvoltage); <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot; V&quot;</span>);</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">print</span>(<span class="string">&quot;Shunt Voltage: &quot;</span>); <span class="built_in">Serial</span>.<span class="built_in">print</span>(shuntvoltage); <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot; mV&quot;</span>);</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">print</span>(<span class="string">&quot;Load Voltage:  &quot;</span>); <span class="built_in">Serial</span>.<span class="built_in">print</span>(loadvoltage); <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot; V&quot;</span>);</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">print</span>(<span class="string">&quot;Current:       &quot;</span>); <span class="built_in">Serial</span>.<span class="built_in">print</span>(current_mA); <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot; mA&quot;</span>);</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">print</span>(<span class="string">&quot;Power:         &quot;</span>); <span class="built_in">Serial</span>.<span class="built_in">print</span>(power_mW); <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot; mW&quot;</span>);</span><br><span class="line"></span><br><span class="line">  currentSub = current_mA-lastCurrent_mA;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">print</span>(<span class="string">&quot;CurrentSub:         &quot;</span>); <span class="built_in">Serial</span>.<span class="built_in">print</span>(currentSub); <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot; mA&quot;</span>);</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span>(currentSub &lt; <span class="number">-3</span>)                <span class="comment">//如果本次電流減上次電流，數值小於-3 mA時</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">digitalWrite</span>(<span class="number">4</span>, <span class="literal">LOW</span>);               <span class="comment">//D4 relay打開 (斷開線路)</span></span><br><span class="line">    <span class="built_in">digitalWrite</span>(<span class="number">2</span>, <span class="literal">HIGH</span>);              <span class="comment">//D2 LED發光 (提醒線路斷開)</span></span><br><span class="line">    <span class="built_in">digitalWrite</span>(<span class="number">3</span>, <span class="literal">LOW</span>);               <span class="comment">//D3 LED不發光</span></span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">1000</span>);                        <span class="comment">//成立時會卡在這邊循環</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果要精準的話，或許可以多次數值的平均數，再看差異。</span></span><br><span class="line"><span class="comment">//怕目前這種程式寫法，只要有突然間斷掉一下，就會relay斷開!!</span></span><br><span class="line"></span><br><span class="line">lastCurrent_mA = current_mA;            <span class="comment">//將保存這次的電流值</span></span><br><span class="line"><span class="built_in">digitalWrite</span>(<span class="number">4</span>, <span class="literal">HIGH</span>);                   <span class="comment">//D4 relay關閉 (不斷開線路)</span></span><br><span class="line"><span class="built_in">digitalWrite</span>(<span class="number">2</span>, <span class="literal">LOW</span>);                   <span class="comment">//D2 LED不發光</span></span><br><span class="line"><span class="built_in">digitalWrite</span>(<span class="number">3</span>, <span class="literal">HIGH</span>);                  <span class="comment">//D3 LED發光 (提醒線路正常)</span></span><br><span class="line"><span class="built_in">delay</span>(<span class="number">1000</span>);                            </span><br><span class="line"><span class="comment">//1000 ms 檢查一次(這邊時間拉長也可以幫助偵測drop的準確度，可以加長這次與下次的偵測時間，更不會受到干擾就斷開relay)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="有螢幕版本">有螢幕版本</h3><p>需要下載 Adafruit_INA219、Adafruit_GFX、SSD1306 庫</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Wire.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Adafruit_INA219.h&gt;</span> <span class="comment">//1.1.1</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Adafruit_GFX.h&gt;</span>    <span class="comment">//1.10.12</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Adafruit_SSD1306.h&gt;</span><span class="comment">//2.5.0</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SCREEN_WIDTH 128 <span class="comment">// OLED display width, in pixels</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SCREEN_HEIGHT 64 <span class="comment">// OLED display height, in pixels</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> OLED_RESET     4 <span class="comment">// Reset pin # (or -1 if sharing Arduino reset pin)</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SCREEN_ADDRESS 0x3C <span class="comment">///&lt; See datasheet for Address; 0x3D for 128x64, 0x3C for 128x32</span></span></span><br><span class="line"><span class="function">Adafruit_SSD1306 <span class="title">display</span><span class="params">(SCREEN_WIDTH, SCREEN_HEIGHT, &amp;<span class="built_in">Wire</span>, OLED_RESET)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> lastCurrent_mA= <span class="number">0</span> ;</span><br><span class="line"><span class="comment">//上一次的電流值(全域變數)，注意：一開始是設定為 0，因此當有電流值時(假設 20 mA)，</span></span><br><span class="line"><span class="comment">//下面會執行 20-0=20 ，因此不會斷路，但如果是突然斷路大於3 mA時，relay會保持斷路。</span></span><br><span class="line"><span class="type">float</span> currentSub = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//這個變數是本次與上次電流相減的值</span></span><br><span class="line">Adafruit_INA219 ina219;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">begin</span>(<span class="number">9600</span>);</span><br><span class="line"></span><br><span class="line">  display.<span class="built_in">begin</span>(SSD1306_SWITCHCAPVCC, <span class="number">0x3C</span>);   </span><br><span class="line">  display.<span class="built_in">clearDisplay</span>();</span><br><span class="line"></span><br><span class="line">  <span class="type">uint32_t</span> currentFrequency;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">pinMode</span>(<span class="number">4</span>, <span class="literal">OUTPUT</span>);</span><br><span class="line">  <span class="built_in">pinMode</span>(<span class="number">2</span>, <span class="literal">OUTPUT</span>);</span><br><span class="line">  <span class="built_in">pinMode</span>(<span class="number">3</span>, <span class="literal">OUTPUT</span>);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(<span class="number">4</span>, <span class="literal">LOW</span>);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(<span class="number">2</span>, <span class="literal">LOW</span>);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(<span class="number">3</span>, <span class="literal">LOW</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">Wire</span>.<span class="built_in">begin</span>();</span><br><span class="line">  ina219.<span class="built_in">begin</span>();</span><br><span class="line">  <span class="comment">//ina219.setCalibration_32V_1A();</span></span><br><span class="line">  ina219.<span class="built_in">setCalibration_16V_400mA</span>();</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot;Measuring voltage and current with INA219 ...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">float</span> shuntvoltage = <span class="number">0</span>;</span><br><span class="line">  <span class="type">float</span> busvoltage = <span class="number">0</span>;</span><br><span class="line">  <span class="type">float</span> current_mA = <span class="number">0</span>;</span><br><span class="line">  <span class="type">float</span> loadvoltage = <span class="number">0</span>;</span><br><span class="line">  <span class="type">float</span> power_mW = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  shuntvoltage = ina219.<span class="built_in">getShuntVoltage_mV</span>();</span><br><span class="line">  busvoltage = ina219.<span class="built_in">getBusVoltage_V</span>();</span><br><span class="line">  current_mA = ina219.<span class="built_in">getCurrent_mA</span>();</span><br><span class="line">  power_mW = ina219.<span class="built_in">getPower_mW</span>();</span><br><span class="line">  loadvoltage = busvoltage + (shuntvoltage / <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">print</span>(<span class="string">&quot;Bus Voltage:   &quot;</span>); <span class="built_in">Serial</span>.<span class="built_in">print</span>(busvoltage); <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot; V&quot;</span>);</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">print</span>(<span class="string">&quot;Shunt Voltage: &quot;</span>); <span class="built_in">Serial</span>.<span class="built_in">print</span>(shuntvoltage); <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot; mV&quot;</span>);</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">print</span>(<span class="string">&quot;Load Voltage:  &quot;</span>); <span class="built_in">Serial</span>.<span class="built_in">print</span>(loadvoltage); <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot; V&quot;</span>);</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">print</span>(<span class="string">&quot;Current:       &quot;</span>); <span class="built_in">Serial</span>.<span class="built_in">print</span>(current_mA); <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot; mA&quot;</span>);</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">print</span>(<span class="string">&quot;Power:         &quot;</span>); <span class="built_in">Serial</span>.<span class="built_in">print</span>(power_mW); <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot; mW&quot;</span>);</span><br><span class="line"></span><br><span class="line">  currentSub = current_mA-lastCurrent_mA;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">print</span>(<span class="string">&quot;CurrentSub:         &quot;</span>); <span class="built_in">Serial</span>.<span class="built_in">print</span>(currentSub); <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot; mA&quot;</span>);</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">  display.<span class="built_in">clearDisplay</span>();</span><br><span class="line">  display.<span class="built_in">setTextSize</span>(<span class="number">1</span>);</span><br><span class="line">  display.<span class="built_in">setTextColor</span>(WHITE);</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">1</span>,<span class="number">5</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot;Bus Voltage:   &quot;</span>));</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">85</span>,<span class="number">5</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(busvoltage);</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">115</span>,<span class="number">5</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot; V&quot;</span>));</span><br><span class="line"></span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">1</span>,<span class="number">15</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot;Shunt Voltage:&quot;</span>));</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">85</span>,<span class="number">15</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(shuntvoltage);</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">115</span>,<span class="number">15</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot;mV&quot;</span>));</span><br><span class="line"></span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">1</span>,<span class="number">25</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot;Load Voltage: &quot;</span>));</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">85</span>,<span class="number">25</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(loadvoltage);</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">115</span>,<span class="number">25</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot; V&quot;</span>));</span><br><span class="line"></span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">1</span>,<span class="number">35</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot;Current:&quot;</span>));</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">85</span>,<span class="number">35</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(current_mA);</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">115</span>,<span class="number">35</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot;mA&quot;</span>));</span><br><span class="line"></span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">1</span>,<span class="number">45</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot;Power:&quot;</span>));</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">85</span>,<span class="number">45</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(power_mW);</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">115</span>,<span class="number">45</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot;mW&quot;</span>));</span><br><span class="line"></span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">1</span>,<span class="number">55</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot;CurrentSub:&quot;</span>));</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">85</span>,<span class="number">55</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(currentSub);</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">115</span>,<span class="number">55</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot;mA&quot;</span>));</span><br><span class="line"></span><br><span class="line">  display.<span class="built_in">display</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span>(currentSub &lt; <span class="number">-1</span>)                <span class="comment">//如果本次電流減上次電流，數值小於 -3 mA 時</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">digitalWrite</span>(<span class="number">4</span>, <span class="literal">LOW</span>);              <span class="comment">//D1 relay 打開 (斷開線路)</span></span><br><span class="line">    <span class="built_in">digitalWrite</span>(<span class="number">2</span>, <span class="literal">HIGH</span>);              <span class="comment">//D2 LED 發光 (提醒線路斷開)</span></span><br><span class="line">    <span class="built_in">digitalWrite</span>(<span class="number">3</span>, <span class="literal">LOW</span>);               <span class="comment">//D3 LED 不發光</span></span><br><span class="line">    shuntvoltage = ina219.<span class="built_in">getShuntVoltage_mV</span>();</span><br><span class="line">    busvoltage = ina219.<span class="built_in">getBusVoltage_V</span>();</span><br><span class="line">    current_mA = ina219.<span class="built_in">getCurrent_mA</span>();</span><br><span class="line">    power_mW = ina219.<span class="built_in">getPower_mW</span>();</span><br><span class="line">    loadvoltage = busvoltage + (shuntvoltage / <span class="number">1000</span>);</span><br><span class="line">    <span class="built_in">Serial</span>.<span class="built_in">print</span>(<span class="string">&quot;Bus Voltage:   &quot;</span>); <span class="built_in">Serial</span>.<span class="built_in">print</span>(busvoltage); <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot; V&quot;</span>);</span><br><span class="line">    <span class="built_in">Serial</span>.<span class="built_in">print</span>(<span class="string">&quot;Shunt Voltage: &quot;</span>); <span class="built_in">Serial</span>.<span class="built_in">print</span>(shuntvoltage); <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot; mV&quot;</span>);</span><br><span class="line">    <span class="built_in">Serial</span>.<span class="built_in">print</span>(<span class="string">&quot;Load Voltage:  &quot;</span>); <span class="built_in">Serial</span>.<span class="built_in">print</span>(loadvoltage); <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot; V&quot;</span>);</span><br><span class="line">    <span class="built_in">Serial</span>.<span class="built_in">print</span>(<span class="string">&quot;Current:       &quot;</span>); <span class="built_in">Serial</span>.<span class="built_in">print</span>(current_mA); <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot; mA&quot;</span>);</span><br><span class="line">    <span class="built_in">Serial</span>.<span class="built_in">print</span>(<span class="string">&quot;Power:         &quot;</span>); <span class="built_in">Serial</span>.<span class="built_in">print</span>(power_mW); <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot; mW&quot;</span>);</span><br><span class="line">    <span class="built_in">Serial</span>.<span class="built_in">print</span>(<span class="string">&quot;CurrentSub:         &quot;</span>); <span class="built_in">Serial</span>.<span class="built_in">print</span>(currentSub); <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="string">&quot; mA&quot;</span>);</span><br><span class="line"></span><br><span class="line">  display.<span class="built_in">clearDisplay</span>();</span><br><span class="line">  display.<span class="built_in">setTextSize</span>(<span class="number">1</span>);</span><br><span class="line">  display.<span class="built_in">setTextColor</span>(BLACK);</span><br><span class="line">  display.<span class="built_in">fillScreen</span>(WHITE);</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">1</span>,<span class="number">5</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot;Bus Voltage:   &quot;</span>));</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">85</span>,<span class="number">5</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(busvoltage);</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">115</span>,<span class="number">5</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot; V&quot;</span>));</span><br><span class="line"></span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">1</span>,<span class="number">15</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot;Shunt Voltage:&quot;</span>));</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">85</span>,<span class="number">15</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(shuntvoltage);</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">115</span>,<span class="number">15</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot;mV&quot;</span>));</span><br><span class="line"></span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">1</span>,<span class="number">25</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot;Load Voltage: &quot;</span>));</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">85</span>,<span class="number">25</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(loadvoltage);</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">115</span>,<span class="number">25</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot; V&quot;</span>));</span><br><span class="line"></span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">1</span>,<span class="number">35</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot;Current:&quot;</span>));</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">85</span>,<span class="number">35</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(current_mA);</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">115</span>,<span class="number">35</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot;mA&quot;</span>));</span><br><span class="line"></span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">1</span>,<span class="number">45</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot;Power:&quot;</span>));</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">85</span>,<span class="number">45</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(power_mW);</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">115</span>,<span class="number">45</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot;mW&quot;</span>));</span><br><span class="line"></span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">1</span>,<span class="number">55</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot;CurrentSub:&quot;</span>));</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">85</span>,<span class="number">55</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(currentSub);</span><br><span class="line">  display.<span class="built_in">setCursor</span>(<span class="number">115</span>,<span class="number">55</span>);</span><br><span class="line">  display.<span class="built_in">print</span>(<span class="built_in">F</span>(<span class="string">&quot;mA&quot;</span>));</span><br><span class="line"></span><br><span class="line">  display.<span class="built_in">display</span>();</span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">200</span>);                        <span class="comment">//成立時會卡在這邊循環</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果要精準的話，或許可以多次數值的平均數，再看差異。</span></span><br><span class="line"><span class="comment">//怕目前這種程式寫法，只要有突然間斷掉一下，就會 relay 斷開!!</span></span><br><span class="line"></span><br><span class="line">lastCurrent_mA = current_mA;            <span class="comment">//將保存這次的電流值</span></span><br><span class="line"><span class="built_in">digitalWrite</span>(<span class="number">4</span>, <span class="literal">HIGH</span>);                   <span class="comment">//D1 relay 關閉 (不斷開線路)</span></span><br><span class="line"><span class="built_in">digitalWrite</span>(<span class="number">2</span>, <span class="literal">LOW</span>);                   <span class="comment">//D2 LED 不發光</span></span><br><span class="line"><span class="built_in">digitalWrite</span>(<span class="number">3</span>, <span class="literal">HIGH</span>);                  <span class="comment">//D3 LED 發光 (提醒線路正常)</span></span><br><span class="line"><span class="built_in">delay</span>(<span class="number">200</span>);                            </span><br><span class="line"><span class="comment">//200 ms 檢查一次(這邊時間拉長也可以幫助偵測drop的準確度，可以加長這次與下次的偵測時間，更不會受到干擾就斷開 relay )</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="參考資料：">參考資料：</h2><ol><li><a href="https://atceiling.blogspot.com/2019/09/arduino63177-tft-lcdina219.html">Arduino筆記(63)：1.77&quot; TFT LCD顯示INA219電流傳感器電壓值</a></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;簡介&quot;&gt;簡介&lt;/h2&gt;
&lt;h3 id=&quot;設計條件&quot;&gt;設計條件&lt;/h3&gt;
&lt;p&gt;剛好有朋友找我設計一個他們實驗要用的裝置，想要做到的效果。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;有一個主要迴路，上面有恆定的電壓，大約 7 V。&lt;/li&gt;
&lt;li&gt;需要用 Arduino 來測量其</summary>
      
    
    
    
    <category term="maker" scheme="https://michaelpig0912.github.io/categories/maker/"/>
    
    
    <category term="arduino" scheme="https://michaelpig0912.github.io/tags/arduino/"/>
    
    <category term="code" scheme="https://michaelpig0912.github.io/tags/code/"/>
    
    <category term="maker" scheme="https://michaelpig0912.github.io/tags/maker/"/>
    
  </entry>
  
  <entry>
    <title>不知道要吃什麼嗎？做一個食物的選擇小工具吧!</title>
    <link href="https://michaelpig0912.github.io/2023/02/11/foodWeb/"/>
    <id>https://michaelpig0912.github.io/2023/02/11/foodWeb/</id>
    <published>2023-02-10T18:30:00.000Z</published>
    <updated>2023-04-05T08:30:54.932Z</updated>
    
    <content type="html"><![CDATA[<h2 id="先來看一下效果吧">先來看一下效果吧</h2><style>  #random-button {    background-color: #06C167;    border: none;    color: black;    padding: 10px;    text-align: center;    text-decoration: none;    display: inline-block;    font-size: 16px;    margin: 10px;    cursor: pointer;  }</style><p>點擊下面的按鈕以獲取一個隨機店家：</p><div><button id="random-button">今天我想來點</button></div><div id="name-display"></div><script>  var names = ["便當店", "吃麵", "吃早餐店"];  var randomButton = document.getElementById("random-button");  var nameDisplay = document.getElementById("name-display");  randomButton.addEventListener("click", function() {    var randomName = names[Math.floor(Math.random() * names.length)];    nameDisplay.textContent = randomName;  });</script><h2 id="接下來看程式碼內容">接下來看程式碼內容</h2><p>這個網址使用 JavaScript 隨機選擇現有名單中的一個店家。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 將店家列表保存在一個陣列中</span></span><br><span class="line"><span class="keyword">var</span> names = [<span class="string">&quot;名字1&quot;</span>, <span class="string">&quot;名字2&quot;</span>, <span class="string">&quot;名字3&quot;</span>, <span class="string">&quot;名字4&quot;</span>, <span class="string">&quot;名字5&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在按鈕點擊時選擇一個隨機店家</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;random-button&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 從店家列表中選擇一個隨機店家</span></span><br><span class="line">  <span class="keyword">var</span> randomName = names[<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * names.<span class="property">length</span>)];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 在網頁上顯示所選店家</span></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;name-display&quot;</span>).<span class="property">textContent</span> = randomName;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>在HTML中，要添加一個按鈕來顯示所選店家：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;random-button&quot;</span>&gt;</span>隨機選擇<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;name-display&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>這樣，當點擊按鈕時，JavaScript代碼會從店家列表中選擇一個隨機名字並顯示在網頁上。</p><h2 id="完整程式碼範例">完整程式碼範例</h2><p>以下可以自己用記事本做的小網站</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>隨機店家產生器<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">font-family</span>: Arial, sans-serif;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-id">#random-button</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-color</span>: <span class="number">#4CAF50</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border</span>: none;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">padding</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">text-decoration</span>: none;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">font-size</span>: <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>隨機店家產生器<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>點擊下面的按鈕以獲取一個隨機店家：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;random-button&quot;</span>&gt;</span>選擇店家<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>所選店家：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;name-display&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> names = [<span class="string">&quot;名字1&quot;</span>, <span class="string">&quot;名字2&quot;</span>, <span class="string">&quot;名字3&quot;</span>, <span class="string">&quot;名字4&quot;</span>, <span class="string">&quot;名字5&quot;</span>];</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> randomButton = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;random-button&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> nameDisplay = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;name-display&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    randomButton.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">var</span> randomName = names[<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * names.<span class="property">length</span>)];</span></span><br><span class="line"><span class="language-javascript">      nameDisplay.<span class="property">textContent</span> = randomName;</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;先來看一下效果吧&quot;&gt;先來看一下效果吧&lt;/h2&gt;
&lt;style&gt;
  #random-button {
    background-color: #06C167;
    border: none;
    color: black;
    padding: 1</summary>
      
    
    
    
    <category term="code" scheme="https://michaelpig0912.github.io/categories/code/"/>
    
    
    <category term="code" scheme="https://michaelpig0912.github.io/tags/code/"/>
    
    <category term="javascript" scheme="https://michaelpig0912.github.io/tags/javascript/"/>
    
    <category term="html" scheme="https://michaelpig0912.github.io/tags/html/"/>
    
  </entry>
  
  <entry>
    <title>網站功能基礎測試</title>
    <link href="https://michaelpig0912.github.io/2023/02/11/webTest/"/>
    <id>https://michaelpig0912.github.io/2023/02/11/webTest/</id>
    <published>2023-02-10T16:53:04.000Z</published>
    <updated>2023-02-12T17:19:44.606Z</updated>
    
    <content type="html"><![CDATA[<h2 id="網站的基本功能測試">網站的基本功能測試</h2><img src="/2023/02/11/webTest/20230204_195004.jpg" class="" title="This is an image"><table><thead><tr><th>Syntax</th><th>Description</th></tr></thead><tbody><tr><td>Header</td><td>Title</td></tr><tr><td>Paragraph</td><td>Text</td></tr></tbody></table><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="string">&quot;JavaScript syntax highlighting&quot;</span>;</span><br><span class="line"><span class="title function_">alert</span>(s);</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">$initHighlight</span>(<span class="params">block, cls</span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (cls.<span class="title function_">search</span>(<span class="regexp">/\bno\-highlight\b/</span>) != -<span class="number">1</span>)</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">process</span>(block, <span class="literal">true</span>, <span class="number">0x0F</span>) +</span><br><span class="line">             <span class="string">&#x27; class=&quot;&quot;&#x27;</span>;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="comment">/* handle exception */</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span> / <span class="number">2</span>; i &lt; classes.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">checkCondition</span>(classes[i]) === <span class="literal">undefined</span>)</span><br><span class="line">      <span class="keyword">return</span> <span class="regexp">/\d+[\s/]/g</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>123</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>a</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if </mtext><mi>b</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>c</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if </mtext><mi>d</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">x = \begin{cases}   a &amp;\text{if } b \\   c &amp;\text{if } d\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathdefault">a</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathdefault">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if </span></span><span class="mord mathdefault">b</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if </span></span><span class="mord mathdefault">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;網站的基本功能測試&quot;&gt;網站的基本功能測試&lt;/h2&gt;
&lt;img src=&quot;/2023/02/11/webTest/20230204_195004.jpg&quot; class=&quot;&quot; title=&quot;This is an image&quot;&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;</summary>
      
    
    
    
    
    <category term="test" scheme="https://michaelpig0912.github.io/tags/test/"/>
    
  </entry>
  
</feed>
